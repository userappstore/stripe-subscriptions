
> @userappstore/stripe-subscriptions@1.0.1036 test /home/ubuntu/workspace
> NODE_ENV=testing mocha src/www/api/user --recursive --timeout 1800000



  /api/user/subscriptions/card-charges-count
    CardChargesCount#GET
      ✓ should count all charges on card (15988ms)

  /api/user/subscriptions/card-charges
    CardCharges#GET
      ✓ should limit card's charges to one page (35662ms)
      ✓ should enforce page size (39875ms)
      ✓ should enforce specified offset (43612ms)

  /api/user/subscriptions/card-invoices-count
    CardInvoicesCount#GET
      ✓ should count all invoices on card (25355ms)

  /api/user/subscriptions/card-invoices
    CardInvoices#GET
      ✓ should limit invoices on card to one page (23227ms)

  /api/user/subscriptions/card-refunds-count
    CardRefundsCount#GET
      ✓ should count all refunds on card (27049ms)

  /api/user/subscriptions/card-refunds
    CardRefunds#GET
      ✓ should limit refunds on card to one page (45432ms)

  /api/user/subscriptions/card-subscriptions-count
    CardSubscriptionsCount#GET
      ✓ should count all subscriptions on card (27884ms)

  /api/user/subscriptions/card-subscriptions
    CardSubscriptions#GET
      ✓ should limit subscriptions on card to one page (33322ms)

  /api/user/subscriptions/card
    Card#GET
      ✓ should reject invalid card (2159ms)
      ✓ should reject other account's card (5518ms)
      ✓ should return card data (3560ms)

  /api/user/subscriptions/cards-count
    CardsCount#GET
      ✓ should count account's cards (6196ms)

  /api/user/subscriptions/cards
    Cards#GET
      ✓ should limit cards to one page (6861ms)

  /api/user/subscriptions/charge
    Charge#GET
      ✓ should reject invalid charge (1855ms)
      ✓ should reject other account's charge (41089ms)
      ✓ should return charge data (22071ms)

  /api/user/subscriptions/charges-count
    Charges#GET
      ✓ should count charges (49209ms)

  /api/user/subscriptions/charges
    Charges#GET
      ✓ should limit charges to one page (54989ms)

  /api/user/subscriptions/create-card
    CreateCard#POST
      ✓ should require name, cvc, number, exp_month and exp_year (1930ms)
      ✓ should create card (3303ms)

  /api/user/subscriptions/create-customer
    CreateCustomer#POST
      ✓ should reject other accountid (3216ms)
      ✓ should reject existing customer (2203ms)
      ✓ should create customer (1911ms)

  /api/user/subscriptions/create-subscription
    CreateSubscription#POST
      ✓ should reject invalid planid (3475ms)
      ✓ should reject never-published planid (7175ms)
      ✓ should reject unpublished plan (8130ms)
      ✓ should reject customer without card (5510ms)
      ✓ should create authorized subscription (8207ms)

  /api/user/subscriptions/customer
    Customer#GET
      ✓ should reject invalid customerid (2188ms)
      ✓ should reject other account's customerid (5524ms)
      ✓ should return customer data (3526ms)

  /api/user/subscriptions/delete-card
    DeleteCard#DELETE
      ✓ should reject invalid cardid (1598ms)
      ✓ should reject other account's card (7967ms)
      ✓ should delete card (4317ms)

  /api/user/subscriptions/delete-subscription
    DeleteSubscription#DELETE
      ✓ should reject invalid subscriptionid (1832ms)
      ✓ should reject other account's subscription (14141ms)
      ✓ should require active subscription (10874ms)
      ✓ should delete subscription at period end (10010ms)
      ✓ should delete subscription immediately (10697ms)

  /api/user/subscriptions/invoice
    Invoice#GET
      ✓ should reject invalid invoice (1945ms)
      1) should reject other account's invoice
      2) should return invoice data

  /api/user/subscriptions/invoices-count
    Invoices#GET
      3) should count invoices

  /api/user/subscriptions/invoices
    Invoices#GET
      4) should limit invoices to one page

  /api/user/subscriptions/published-plan
    PublishedPlan#GET
      ✓ should not require account (3790ms)
      ✓ should reject never published plan (5435ms)
