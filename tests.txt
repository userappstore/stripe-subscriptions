

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/bind-stripekey
    after
      ✓ should bind data to req (68ms)

  server/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (7071ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (6533ms)
      ✓ should ignore user without pending confirmation (7422ms)
      ✓ should require user confirm payment (7359ms)

  server/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2105ms)
      ✓ should ignore administrator with amount owed requesting administration pages (2169ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (17599ms)
      ✓ should require user pay overdue invoice (4834ms)

  server/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages (40ms)
      ✓ should ignore administrator without subscription requesting administration pages
      ✓ should ignore user with active subscription (8365ms)
      ✓ should require user create subscription (77ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (1120ms)
      ✓ should present the form for stripe.js v3 (2153ms)
    submit
      ✓ should require name for no stripe.js (6309ms)
      ✓ should require CVC for no stripe.js (6349ms)
      ✓ should require card number for no stripe.js (6020ms)
      ✓ should require expiration month for no stripe.js (6294ms)
      ✓ should require expiration year for no stripe.js (6254ms)
      ✓ should add payment information no stripe.js (screenshots) (137652ms)
      ✓ should add payment information stripe.js v3 (21097ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (236ms)
      ✓ should reject other account's customer (263ms)
      ✓ should bind data to req (241ms)
    view
      ✓ should have row for customer (screenshots) (40512ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (6823ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (167ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (747ms)
      ✓ should present the form for stripe.js v3 (1594ms)
    submit
      ✓ should require description for no stripe.js (7093ms)
      ✓ should require email for no stripe.js (6638ms)
      ✓ should require name for no stripe.js (6865ms)
      ✓ should require CVC for no stripe.js (7179ms)
      ✓ should require card number for no stripe.js (6742ms)
      ✓ should require expiration month for no stripe.js (7014ms)
      ✓ should require expiration year for no stripe.js (7044ms)
      ✓ should require description for stripe.js v3 (18515ms)
      ✓ should require email for stripe.js v3 (18473ms)
      ✓ should create billing profile for no stripe.js (8482ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (215990ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (160ms)
      ✓ should reject never published plan (667ms)
      ✓ should reject unpublished plan (856ms)
      ✓ should bind data to req (673ms)
    view
      ✓ should have row for plan (screenshots) (39629ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (876ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (204ms)
      ✓ should reject customer with coupon (2426ms)
    before
      ✓ should bind data to req (1148ms)
    view
      ✓ should present the form (4098ms)
    submit
      ✓ should apply coupon (screenshots) (76986ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (230ms)
      ✓ should reject canceling subscription (9178ms)
      ✓ should reject free subscription (6274ms)
      ✓ should reject subscription with coupon (10224ms)
    before
      ✓ should bind data to req (8535ms)
    view
      ✓ should present the form (8806ms)
    submit
      ✓ should apply coupon (screenshots) (80775ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (1968ms)
      ✓ should bind data to req (8762ms)
    view
      ✓ should present the charge table (screenshots) (55676ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (183ms)
      ✓ should bind data to req (420ms)
    view
      ✓ should present the coupon table (screenshots) (47850ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (654ms)
    submit
      ✓ should reject missing couponid (1389ms)
      ✓ should enforce couponid length (2396ms)
      ✓ should reject duplicate couponid (2181ms)
      ✓ should reject missing duration (1793ms)
      ✓ should enforce invalid duration (1880ms)
      ✓ should require valid amount off (1924ms)
      ✓ should require valid percent off (1768ms)
      ✓ should require valid max redemptions (1814ms)
      ✓ should require amount or percent off (1705ms)
      ✓ should require valid duration in months if repeating (1914ms)
      ✓ should require valid redeem_by if provided (2111ms)
      ✓ should create coupon (screenshots) (60513ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (938ms)
    submit
      ✓ should reject missing planid (1749ms)
      ✓ should enforce planid length (2667ms)
      ✓ should reject missing productid (1718ms)
      ✓ should reject never published product (2198ms)
      ✓ should reject unpublished product (2422ms)
      ✓ should reject missing currency (2283ms)
      ✓ should reject invalid currency (2238ms)
      ✓ should reject missing usage_type (2107ms)
      ✓ should reject missing amount (2119ms)
      ✓ should reject invalid amount (2135ms)
      ✓ should reject missing interval (2170ms)
      ✓ should reject invalid interval (2185ms)
      ✓ should reject invalid interval_count (2106ms)
      ✓ should reject invalid trial_period_days (2274ms)
      ✓ should create plan (screenshots) (60753ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (543ms)
    submit
      ✓ should reject missing name (1325ms)
      ✓ should enforce name length (2259ms)
      ✓ should reject missing statement_descriptor (1279ms)
      ✓ should create product (screenshots) (60043ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (408ms)
      ✓ should bind data to req (267ms)
    view
      ✓ should present the customer table (screenshots) (39490ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (166ms)
    before
      ✓ should bind data to req (339ms)
    view
      ✓ should present the form (828ms)
    submit
      ✓ should delete coupon (screenshots) (71711ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (162ms)
    before
      ✓ should bind data to req (715ms)
    view
      ✓ should present the form (1318ms)
    submit
      ✓ should delete plan (screenshots) (71498ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (151ms)
    before
      ✓ should bind data to req (309ms)
    view
      ✓ should present the form (787ms)
    submit
      ✓ should delete product (screenshots) (69495ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5727ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (155ms)
      ✓ should reject charge without refund request (8240ms)
      ✓ should reject denied refund (7675ms)
    before
      ✓ should bind data to req (8339ms)
    view
      ✓ should present the form (8967ms)
    submit
      ✓ should deny refund (screenshots) (89194ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (510ms)
      ✓ should bind data to req (314ms)
    view
      ✓ should present the form (870ms)
    submit
      ✓ should reject missing name (1311ms)
      ✓ should update coupon (screenshots) (72796ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (164ms)
      ✓ should reject unpublished plan (986ms)
      ✓ should bind data to req (868ms)
    view
      ✓ should present the form (1325ms)
    submit
      ✓ should reject missing productid (2108ms)
      ✓ should reject invalid trial period (2601ms)
      ✓ should update plan (screenshots) (74754ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (139ms)
      ✓ should reject unpublished product (530ms)
      ✓ should bind data to req (310ms)
    view
      ✓ should present the form (824ms)
    submit
      ✓ should reject missing name (1602ms)
      ✓ should enforce name length (2515ms)
      ✓ should reject missing statement_descriptor (1582ms)
      ✓ should reject invalid unit_label (2107ms)
      ✓ should update product (screenshots) (77819ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (167ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (160ms)
      ✓ should reject paid invoice (8645ms)
      ✓ should reject uncollectible invoice (3323ms)
    before
      ✓ should bind data to req (2325ms)
    view
      ✓ should present the form (3181ms)
    submit
      ✓ should forgive invoice (screenshots) (68574ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (8526ms)
    view
      ✓ should have row for each plan (1661ms)
      ✓ should have row for each coupon (1195ms)
      ✓ should have row for each subscription (screenshots) (33683ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (156ms)
      ✓ should bind data to req (7331ms)
    view
      ✓ should present the invoice table (screenshots) (55407ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (1918ms)
    view
      ✓ should have row for payment intent (screenshots) (47805ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (1933ms)
    view
      ✓ should have row for payment method (screenshots) (48417ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (166ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (162ms)
      ✓ should bind data to req (684ms)
    view
      ✓ should present the plan table (screenshots) (47417ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (159ms)
      ✓ should bind data to req (320ms)
    view
      ✓ should have row for product (screenshots) (44872ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (148ms)
      ✓ should reject published coupon (300ms)
    before
      ✓ should bind data to req (334ms)
    view
      ✓ should present the form (817ms)
    submit
      ✓ should publish coupon (screenshots) (70649ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (160ms)
      ✓ should reject published plan (694ms)
    before
      ✓ should bind data to req (648ms)
    view
      ✓ should present the form (1214ms)
    submit
      ✓ should publish plan (screenshots) (71537ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (161ms)
      ✓ should reject published product (330ms)
    before
      ✓ should bind data to req (332ms)
    view
      ✓ should present the form (859ms)
    submit
      ✓ should publish product (screenshots) (68390ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (159ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (162ms)
      ✓ should bind data to req (11437ms)
    view
      ✓ should have row for refund (screenshots) (55827ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (164ms)
      ✓ should reject customer without discount (959ms)
    before
      ✓ should bind data to req (2028ms)
    view
      ✓ should present the form (2513ms)
    submit
      ✓ should remove coupon (screenshots) (68195ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (154ms)
      ✓ should reject subscription without discount (9376ms)
    before
      ✓ should bind data to req (8315ms)
    view
      ✓ should present the form (8880ms)
    submit
      ✓ should remove coupon (screenshots) (80160ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (3131ms)
    view
      ✓ should have row for setup intent (screenshots) (50310ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (175ms)
      ✓ should bind data to req (8210ms)
    view
      ✓ should present the subscription table (screenshots) (52608ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (177ms)
      ✓ should reject never published coupon (325ms)
      ✓ should reject unpublished coupon (486ms)
    before
      ✓ should bind data to req (324ms)
    view
      ✓ should present the form (840ms)
    submit
      ✓ should unpublish coupon (screenshots) (71202ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (163ms)
      ✓ should never published plan (714ms)
      ✓ should reject unpublished plan (858ms)
    before
      ✓ should bind data to req (688ms)
    view
      ✓ should present the form (1246ms)
    submit
      ✓ should unpublish plan (screenshots) (71219ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (148ms)
      ✓ should never published product (330ms)
      ✓ should reject unpublished product (509ms)
    before
      ✓ should bind data to req (334ms)
    view
      ✓ should present the form (832ms)
    submit
      ✓ should unpublish product (screenshots) (68590ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid (55ms)
        ✓ invalid querystring chargeid (183ms)
    returns
      ✓ object (10415ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (25912ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid (43ms)
        ✓ invalid querystring couponid (418ms)
    returns
      ✓ object (430ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (599ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (170ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9334ms)
    returns
      ✓ object (9880ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (221ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (218ms)
      invalid-planid-length
        ✓ posted planid is too short (248ms)
        ✓ posted planid is too long (230ms)
      invalid-productid
        ✓ missing posted productid (190ms)
        ✓ invalid posted productid (359ms)
      invalid-product
        ✓ ineligible posted product is not published (352ms)
      invalid-amount
        ✓ missing posted amount (355ms)
        ✓ invalid posted amount (337ms)
      invalid-currency
        ✓ missing posted currency (232ms)
        ✓ invalid posted currency (197ms)
      invalid-interval
        ✓ missing posted interval (537ms)
        ✓ invalid posted interval (610ms)
      invalid-interval-count
        ✓ missing posted interval_count (347ms)
        ✓ invalid posted interval_count (347ms)
      invalid-trial_period
        ✓ invalid posted trial_period (360ms)
      invalid-usage_type
        ✓ invalid posted usage_type (315ms)
    receives
      ✓ optional posted published (boolean) (561ms)
      ✓ optional posted trial_period_days (integer) (751ms)
      ✓ optional posted usage_type (licensed|metered) (547ms)
    returns
      ✓ object (847ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (204ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (194ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (382ms)
    returns
      ✓ object (395ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (180ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (163ms)
    returns
      ✓ object (3016ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (526ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (172ms)
    returns
      ✓ boolean (529ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (174ms)
    returns
      ✓ boolean (2228ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (163ms)
    returns
      ✓ boolean (596ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (176ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8710ms)
    returns
      ✓ boolean (7625ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (149ms)
    returns
      ✓ object (8551ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (30646ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (2411ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5971ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1726ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (4902ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (197ms)
    returns
      ✓ object (730ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (1441ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (151ms)
    returns
      ✓ object (326ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (559ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (24767ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (161ms)
    returns
      ✓ object (9996ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (28340ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (162ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (268ms)
    receives
      ✓ object (1236ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (165ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (6967ms)
    returns
      ✓ object (9364ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (159ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (7715ms)
    returns
      ✓ object (7574ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (171ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (357ms)
        ✓ ineligible querystring coupon is unpublished (306ms)
    returns
      ✓ object (517ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (154ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (332ms)
        ✓ ineligible querystring coupon is already unpublished (532ms)
    returns
      ✓ object (517ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (159ms)
        ✓ invalid querystring invoiceid (155ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8381ms)
        ✓ invalid querystring invoice is marked uncollectable (4688ms)
    returns
      ✓ object (4810ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (335ms)
      invalid-plan
        ✓ ineligible querystring plan is published (672ms)
    returns
      ✓ object (885ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (158ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (907ms)
        ✓ ineligible querystring plan is already unpublished (866ms)
    returns
      ✓ object (932ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (477ms)
        ✓ invalid querystring productid (310ms)
      invalid-product
        ✓ invalid querystring product is already published (323ms)
    returns
      ✓ object (501ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (213ms)
        ✓ invalid querystring productid (331ms)
      invalid-product
        ✓ ineligible querystring product is not published (353ms)
        ✓ ineligible querystring product is already unpublished (553ms)
    returns
      ✓ object (494ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (148ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (8460ms)
        ✓ ineligible querystring charge has denied request already (7683ms)
    returns
      ✓ object (8225ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (167ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8856ms)
    returns
      ✓ object (8034ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (8736ms)
        ✓ ineligible subscription has coupon (8080ms)
      invalid-couponid
        ✓ missing posted couponid (7663ms)
        ✓ invalid posted couponid (6875ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (8266ms)
        ✓ ineligible posted coupon is unpublished (8906ms)
    returns
      ✓ object (8428ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
    returns
      ✓ object (3038ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4771ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (172ms)
    returns
      ✓ object (7487ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (22940ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (181ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (505ms)
      invalid-name
        ✓ missing posted name (336ms)
        ✓ invalid posted name (339ms)
    receives
      ✓ required posted name (520ms)
    returns
      ✓ object (511ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (239ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (1168ms)
      invalid-productid
        ✓ invalid posted productid (798ms)
      invalid-product
        ✓ ineligible posted product is not published (964ms)
        ✓ ineligible posted product is unpublished (1124ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (1024ms)
        ✓ ineligible posted trial_period_days is negative (1146ms)
        ✓ ineligible posted trial_period_days greater than 365 (969ms)
    receives
      ✓ optional posted trial_period_days (integer) (875ms)
    returns
      ✓ object (1143ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (195ms)
        ✓ invalid querystring productid (348ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (536ms)
      invalid-name
        ✓ invalid posted name (333ms)
      invalid-name-length
        ✓ posted name too short (318ms)
        ✓ posted name too long (366ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (325ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (351ms)
        ✓ posted statement_descriptor too long (323ms)
      invalid-unit_label
        ✓ missing posted unit_label (458ms)
    receives
      ✓ optional posted name (477ms)
      ✓ optional posted statement_descriptor (527ms)
      ✓ optional posted unit_label (548ms)
    returns
      ✓ object (524ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (328ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (321ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (12548ms)
    returns
      ✓ object (7299ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (15936ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (52ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7913ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8420ms)
        ✓ ineligible querystring subscription is free (7090ms)
        ✓ ineligible querystring subscription is in free trial (6038ms)
    returns
      ✓ object (7946ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (52ms)
    returns
      ✓ object (215ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1525ms)
        ✓ ineligible posted payment method (1761ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (238ms)
        ✓ invalid posted paymentmethodid (241ms)
    object
      ✓ object (1684ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (293ms)
    receives
      ✓ optionally-required posted name (238ms)
      ✓ optionally-required posted cvc (269ms)
      ✓ optionally-required posted number (428ms)
      ✓ optionally-required posted exp_month (222ms)
      ✓ optionally-required posted exp_year (249ms)
      ✓ optionally-required posted token (240ms)
    returns
      ✓ object (1546ms)
    configuration
      ✓ environment STRIPE_JS (356ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (8855ms)
        ✓ ineligible querystring charge has refund request (7851ms)
      invalid-account
        ✓ ineligible accessing account (8473ms)
    returns
      ✓ object (7865ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (8994ms)
        ✓ ineligible querystring charge is out of refund period (7833ms)
      invalid-account
        ✓ ineligible accessing account (11401ms)
    returns
      ✓ object (9159ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (8074ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1669ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (241ms)
        ✓ invalid posted paymentmethodid (224ms)
    returns
      ✓ object (1711ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (560ms)
        ✓ invalid querystring customerid (686ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (1445ms)
      invalid-account
        ✓ ineligible accessing account (1042ms)
      invalid-planid
        ✓ missing posted planid (2177ms)
        ✓ invalid posted planid (2066ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2253ms)
        ✓ ineligible posted plan is unpublished (2580ms)
    returns
      ✓ object (4227ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid (93ms)
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (8007ms)
      invalid-account
        ✓ ineligible accessing account (5383ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (5450ms)
        ✓ invalid posted quantity is negative (5063ms)
      invalid-action
        ✓ missing posted action (5787ms)
        ✓ invalid posted action (5650ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (5533ms)
        ✓ invalid posted subscriptionitemid (5731ms)
    receives
      ✓ required posted quantity (5912ms)
      ✓ required posted action (5805ms)
      ✓ required posted subscriptionitemid (5818ms)
    returns
      ✓ object (6904ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1581ms)
    returns
      ✓ object (1663ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (48ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (305ms)
    returns
      ✓ boolean (422ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7759ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8399ms)
    returns
      ✓ boolean (6930ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (9754ms)
    returns
      ✓ object (8307ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (18749ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (57ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (1840ms)
    returns
      ✓ object (2106ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (5952ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (52ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1966ms)
    returns
      ✓ object (1866ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (6129ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (46ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (140ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (711ms)
    returns
      ✓ object (785ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1320ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (140ms)
      invalid-product
        ✓ ineligible querystring product is not published (356ms)
    returns
      ✓ object (352ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (430ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (593ms)
        ✓ invalid querystring refundid (792ms)
      invalid-account
        ✓ ineligible accessing account (10703ms)
    returns
      ✓ object (8681ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (25290ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (53ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (8392ms)
      invalid-account
        ✓ ineligible accessing account (8226ms)
    returns
      ✓ object (8832ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (391ms)
        ✓ invalid querystring customerid (224ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (1221ms)
      invalid-account
        ✓ ineligible account accessing (459ms)
      invalid-couponid
        ✓ missing posted couponid (225ms)
        ✓ invalid posted couponid (264ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (576ms)
        ✓ invalid posted coupon is unpublished (787ms)
    returns
      ✓ object (917ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2121ms)
        ✓ ineligible posted payment method (7284ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8951ms)
        ✓ invalid querystring invoice is marked uncollectable (5743ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2271ms)
        ✓ invalid posted paymentmethodid (2941ms)
    returns
      ✓ object (5797ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (2159ms)
    returns
      ✓ object (2168ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1776ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1773ms)
    returns
      ✓ object (3690ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (2663ms)
    returns
      ✓ object (3357ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (8017ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8974ms)
    returns
      ✓ object (8034ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (8839ms)
        ✓ invalid querystring subscription is canceling (8430ms)
      invalid-account
        ✓ ineligible accessing account (7386ms)
      invalid-couponid
        ✓ missing posted couponid (7633ms)
        ✓ invalid posted couponid (7666ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (10537ms)
        ✓ invalid posted coupon is unpublished (7930ms)
        ✓ invalid posted coupon is other currency (7426ms)
    returns
      ✓ object (8088ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14763ms)
      invalid-planid
        ✓ missing posted planid (7472ms)
        ✓ invalid posted planid (7500ms)
      invalid-plan
        ✓ invalid posted plan is not published (8137ms)
        ✓ invalid posted plan is unpublished (8145ms)
        ✓ invalid posted plan is unchanged (7818ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (19892ms)
    returns
      ✓ object (15424ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (8620ms)
      invalid-quantity
        ✓ invalid posted quantity (8061ms)
        ✓ invalid posted quantity is unchanged (7563ms)
        ✓ invalid posted quantity is negative (7894ms)
        ✓ invalid posted quantity is zero (8010ms)
    returns
      ✓ object (7652ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7393ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (7446ms)
        ✓ invalid posted tax_percent is unchanged (8396ms)
        ✓ invalid posted tax_percent is negative (7099ms)
    returns
      ✓ object (8989ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (6044ms)
    returns
      ✓ object (3856ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (4635ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid (39ms)
      invalid-account
        ✓ ineligible accessing account (58ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14942ms)
    returns
      ✓ object (8455ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (47ms)
    returns
      ✓ integer (11774ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (49ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (15896ms)
      invalid-subscription
        ✓ ineligible querystring subscription (15522ms)
    returns
      ✓ object (9070ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

