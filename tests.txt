

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/bind-stripekey
    after
      ✓ should bind data to req (57ms)

  server/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (6184ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (6634ms)
      ✓ should ignore user without pending confirmation (7008ms)
      ✓ should require user confirm payment (5986ms)

  server/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2022ms)
      ✓ should ignore administrator with amount owed requesting administration pages (2151ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (5670ms)
      ✓ should require user pay overdue invoice (6052ms)

  server/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages
      ✓ should ignore administrator without subscription requesting administration pages
      ✓ should ignore user with active subscription (7803ms)
      ✓ should require user create subscription (49ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (2842ms)
      ✓ should present the form for stripe.js v3 (2265ms)
    submit
      ✓ should require name for no stripe.js (6122ms)
      ✓ should require CVC for no stripe.js (6207ms)
      ✓ should require card number for no stripe.js (5880ms)
      ✓ should require expiration month for no stripe.js (6205ms)
      ✓ should require expiration year for no stripe.js (6199ms)
      ✓ should add payment information no stripe.js (screenshots) (132602ms)
      ✓ should add payment information stripe.js v3 (21363ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (249ms)
      ✓ should reject other account's customer (270ms)
      ✓ should bind data to req (230ms)
    view
      ✓ should have row for customer (screenshots) (39255ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (7649ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (160ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (668ms)
      ✓ should present the form for stripe.js v3 (1451ms)
    submit
      ✓ should require description for no stripe.js (6804ms)
      ✓ should require email for no stripe.js (6497ms)
      ✓ should require name for no stripe.js (6585ms)
      ✓ should require CVC for no stripe.js (7233ms)
      ✓ should require card number for no stripe.js (6611ms)
      ✓ should require expiration month for no stripe.js (7009ms)
      ✓ should require expiration year for no stripe.js (6940ms)
      ✓ should require description for stripe.js v3 (18475ms)
      ✓ should require email for stripe.js v3 (18196ms)
      ✓ should create billing profile for no stripe.js (8767ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (212583ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (156ms)
      ✓ should reject never published plan (672ms)
      ✓ should reject unpublished plan (859ms)
      ✓ should bind data to req (675ms)
    view
      ✓ should have row for plan (screenshots) (38203ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (572ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (149ms)
      ✓ should reject customer with coupon (2503ms)
    before
      ✓ should bind data to req (897ms)
    view
      ✓ should present the form (1267ms)
    submit
      ✓ should apply coupon (screenshots) (71864ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (163ms)
      ✓ should reject canceling subscription (8151ms)
      ✓ should reject free subscription (6077ms)
      ✓ should reject subscription with coupon (8924ms)
    before
      ✓ should bind data to req (7831ms)
    view
      ✓ should present the form (8197ms)
    submit
      ✓ should apply coupon (screenshots) (77736ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (975ms)
      ✓ should bind data to req (7902ms)
    view
      ✓ should present the charge table (screenshots) (53205ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (144ms)
      ✓ should bind data to req (306ms)
    view
      ✓ should present the coupon table (screenshots) (45428ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (688ms)
    submit
      ✓ should reject missing couponid (1336ms)
      ✓ should enforce couponid length (2250ms)
      ✓ should reject duplicate couponid (2083ms)
      ✓ should reject missing duration (1751ms)
      ✓ should enforce invalid duration (1777ms)
      ✓ should require valid amount off (1826ms)
      ✓ should require valid percent off (1711ms)
      ✓ should require valid max redemptions (1794ms)
      ✓ should require amount or percent off (1598ms)
      ✓ should require valid duration in months if repeating (1887ms)
      ✓ should require valid redeem_by if provided (2054ms)
      ✓ should create coupon (screenshots) (58271ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (891ms)
    submit
      ✓ should reject missing planid (1799ms)
      ✓ should enforce planid length (2640ms)
      ✓ should reject missing productid (1658ms)
      ✓ should reject never published product (2458ms)
      ✓ should reject unpublished product (2528ms)
      ✓ should reject missing currency (2187ms)
      ✓ should reject invalid currency (2113ms)
      ✓ should reject missing usage_type (2098ms)
      ✓ should reject missing amount (2076ms)
      ✓ should reject invalid amount (2146ms)
      ✓ should reject missing interval (2372ms)
      ✓ should reject invalid interval (2317ms)
      ✓ should reject invalid interval_count (2131ms)
      ✓ should reject invalid trial_period_days (2287ms)
      ✓ should create plan (screenshots) (58971ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (487ms)
    submit
      ✓ should reject missing name (1315ms)
      ✓ should enforce name length (2222ms)
      ✓ should reject missing statement_descriptor (1205ms)
      ✓ should create product (screenshots) (57937ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (405ms)
      ✓ should bind data to req (675ms)
    view
      ✓ should present the customer table (screenshots) (38614ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (170ms)
    before
      ✓ should bind data to req (299ms)
    view
      ✓ should present the form (783ms)
    submit
      ✓ should delete coupon (screenshots) (70565ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (157ms)
    before
      ✓ should bind data to req (692ms)
    view
      ✓ should present the form (1123ms)
    submit
      ✓ should delete plan (screenshots) (70402ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (159ms)
    before
      ✓ should bind data to req (346ms)
    view
      ✓ should present the form (810ms)
    submit
      ✓ should delete product (screenshots) (67139ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5029ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (215ms)
      ✓ should reject charge without refund request (8074ms)
      ✓ should reject denied refund (7906ms)
    before
      ✓ should bind data to req (8381ms)
    view
      ✓ should present the form (8401ms)
    submit
      ✓ should deny refund (screenshots) (90107ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (670ms)
      ✓ should bind data to req (321ms)
    view
      ✓ should present the form (753ms)
    submit
      ✓ should reject missing name (1252ms)
      ✓ should update coupon (screenshots) (70703ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (155ms)
      ✓ should reject unpublished plan (919ms)
      ✓ should bind data to req (916ms)
    view
      ✓ should present the form (1277ms)
    submit
      ✓ should reject missing productid (1947ms)
      ✓ should reject invalid trial period (2495ms)
      ✓ should update plan (screenshots) (72765ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (145ms)
      ✓ should reject unpublished product (480ms)
      ✓ should bind data to req (293ms)
    view
      ✓ should present the form (850ms)
    submit
      ✓ should reject missing name (1535ms)
      ✓ should enforce name length (2471ms)
      ✓ should reject missing statement_descriptor (1463ms)
      ✓ should reject invalid unit_label (1835ms)
      ✓ should update product (screenshots) (75675ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (149ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (149ms)
      ✓ should reject paid invoice (7271ms)
      ✓ should reject uncollectible invoice (2592ms)
    before
      ✓ should bind data to req (2647ms)
    view
      ✓ should present the form (3816ms)
    submit
      ✓ should forgive invoice (screenshots) (66935ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (7961ms)
    view
      ✓ should have row for each plan (1789ms)
      ✓ should have row for each coupon (1290ms)
      ✓ should have row for each subscription (screenshots) (33185ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (143ms)
      ✓ should bind data to req (7944ms)
    view
      ✓ should present the invoice table (screenshots) (52296ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (2067ms)
    view
      ✓ should have row for payment intent (screenshots) (46940ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (1539ms)
    view
      ✓ should have row for payment method (screenshots) (47437ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (158ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (143ms)
      ✓ should bind data to req (672ms)
    view
      ✓ should present the plan table (screenshots) (46024ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (140ms)
      ✓ should bind data to req (319ms)
    view
      ✓ should have row for product (screenshots) (43359ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (152ms)
      ✓ should reject published coupon (348ms)
    before
      ✓ should bind data to req (312ms)
    view
      ✓ should present the form (799ms)
    submit
      ✓ should publish coupon (screenshots) (69441ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (165ms)
      ✓ should reject published plan (649ms)
    before
      ✓ should bind data to req (646ms)
    view
      ✓ should present the form (1158ms)
    submit
      ✓ should publish plan (screenshots) (69378ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (147ms)
      ✓ should reject published product (326ms)
    before
      ✓ should bind data to req (321ms)
    view
      ✓ should present the form (807ms)
    submit
      ✓ should publish product (screenshots) (66341ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (145ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (158ms)
      ✓ should bind data to req (8874ms)
    view
      ✓ should have row for refund (screenshots) (56577ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (167ms)
      ✓ should reject customer without discount (1092ms)
    before
      ✓ should bind data to req (1372ms)
    view
      ✓ should present the form (1901ms)
    submit
      ✓ should remove coupon (screenshots) (65389ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (154ms)
      ✓ should reject subscription without discount (8250ms)
    before
      ✓ should bind data to req (8734ms)
    view
      ✓ should present the form (9496ms)
    submit
      ✓ should remove coupon (screenshots) (80453ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (3015ms)
    view
      ✓ should have row for setup intent (screenshots) (49107ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (154ms)
      ✓ should bind data to req (7205ms)
    view
      ✓ should present the subscription table (screenshots) (52267ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (157ms)
      ✓ should reject never published coupon (325ms)
      ✓ should reject unpublished coupon (514ms)
    before
      ✓ should bind data to req (510ms)
    view
      ✓ should present the form (797ms)
    submit
      ✓ should unpublish coupon (screenshots) (69148ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (161ms)
      ✓ should never published plan (662ms)
      ✓ should reject unpublished plan (879ms)
    before
      ✓ should bind data to req (698ms)
    view
      ✓ should present the form (1150ms)
    submit
      ✓ should unpublish plan (screenshots) (69537ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (196ms)
      ✓ should never published product (316ms)
      ✓ should reject unpublished product (498ms)
    before
      ✓ should bind data to req (309ms)
    view
      ✓ should present the form (786ms)
    submit
      ✓ should unpublish product (screenshots) (66485ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (166ms)
    returns
      ✓ object (6990ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (24802ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (145ms)
    returns
      ✓ object (350ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (523ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (144ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9463ms)
    returns
      ✓ object (8961ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (178ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (184ms)
      invalid-planid-length
        ✓ posted planid is too short (184ms)
        ✓ posted planid is too long (183ms)
      invalid-productid
        ✓ missing posted productid (202ms)
        ✓ invalid posted productid (307ms)
      invalid-product
        ✓ ineligible posted product is not published (300ms)
      invalid-amount
        ✓ missing posted amount (317ms)
        ✓ invalid posted amount (328ms)
      invalid-currency
        ✓ missing posted currency (174ms)
        ✓ invalid posted currency (203ms)
      invalid-interval
        ✓ missing posted interval (306ms)
        ✓ invalid posted interval (519ms)
      invalid-interval-count
        ✓ missing posted interval_count (312ms)
        ✓ invalid posted interval_count (294ms)
      invalid-trial_period
        ✓ invalid posted trial_period (302ms)
      invalid-usage_type
        ✓ invalid posted usage_type (306ms)
    receives
      ✓ optional posted published (boolean) (534ms)
      ✓ optional posted trial_period_days (integer) (543ms)
      ✓ optional posted usage_type (licensed|metered) (550ms)
    returns
      ✓ object (534ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (194ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (178ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (355ms)
    returns
      ✓ object (375ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (155ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (142ms)
    returns
      ✓ object (3117ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (522ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (149ms)
    returns
      ✓ boolean (488ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (150ms)
    returns
      ✓ boolean (868ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (151ms)
    returns
      ✓ boolean (508ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (159ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8284ms)
    returns
      ✓ boolean (8822ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (153ms)
    returns
      ✓ object (8648ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (32437ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (1888ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5575ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1763ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (4212ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (157ms)
    returns
      ✓ object (672ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (1217ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (148ms)
    returns
      ✓ object (336ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (502ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (24743ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (154ms)
    returns
      ✓ object (8854ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (27712ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (145ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (235ms)
    receives
      ✓ object (1055ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (155ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (7475ms)
    returns
      ✓ object (11749ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (168ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (8304ms)
    returns
      ✓ object (8090ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (147ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (308ms)
        ✓ ineligible querystring coupon is unpublished (333ms)
    returns
      ✓ object (485ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (150ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (321ms)
        ✓ ineligible querystring coupon is already unpublished (516ms)
    returns
      ✓ object (520ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (156ms)
        ✓ invalid querystring invoiceid (156ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8101ms)
        ✓ invalid querystring invoice is marked uncollectable (5649ms)
    returns
      ✓ object (5395ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (161ms)
      invalid-plan
        ✓ ineligible querystring plan is published (705ms)
    returns
      ✓ object (901ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (171ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (852ms)
        ✓ ineligible querystring plan is already unpublished (1130ms)
    returns
      ✓ object (940ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (311ms)
        ✓ invalid querystring productid (333ms)
      invalid-product
        ✓ invalid querystring product is already published (298ms)
    returns
      ✓ object (562ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (183ms)
        ✓ invalid querystring productid (318ms)
      invalid-product
        ✓ ineligible querystring product is not published (314ms)
        ✓ ineligible querystring product is already unpublished (529ms)
    returns
      ✓ object (502ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (148ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (8031ms)
        ✓ ineligible querystring charge has denied request already (8079ms)
    returns
      ✓ object (8826ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (156ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8416ms)
    returns
      ✓ object (8394ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (9195ms)
        ✓ ineligible subscription has coupon (9118ms)
      invalid-couponid
        ✓ missing posted couponid (7631ms)
        ✓ invalid posted couponid (7912ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (7531ms)
        ✓ ineligible posted coupon is unpublished (8278ms)
    returns
      ✓ object (8753ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
    returns
      ✓ object (3021ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4583ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (154ms)
    returns
      ✓ object (7480ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (24075ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (154ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (501ms)
      invalid-name
        ✓ missing posted name (327ms)
        ✓ invalid posted name (340ms)
    receives
      ✓ required posted name (525ms)
    returns
      ✓ object (689ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (161ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (1018ms)
      invalid-productid
        ✓ invalid posted productid (869ms)
      invalid-product
        ✓ ineligible posted product is not published (938ms)
        ✓ ineligible posted product is unpublished (1535ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (972ms)
        ✓ ineligible posted trial_period_days is negative (1157ms)
        ✓ ineligible posted trial_period_days greater than 365 (905ms)
    receives
      ✓ optional posted trial_period_days (integer) (950ms)
    returns
      ✓ object (1152ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (355ms)
        ✓ invalid querystring productid (343ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (499ms)
      invalid-name
        ✓ invalid posted name (328ms)
      invalid-name-length
        ✓ posted name too short (305ms)
        ✓ posted name too long (328ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (316ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (326ms)
        ✓ posted statement_descriptor too long (303ms)
      invalid-unit_label
        ✓ missing posted unit_label (337ms)
    receives
      ✓ optional posted name (480ms)
      ✓ optional posted statement_descriptor (477ms)
      ✓ optional posted unit_label (827ms)
    returns
      ✓ object (476ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (316ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (307ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (13972ms)
    returns
      ✓ object (6836ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (18025ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (43ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (8281ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9708ms)
        ✓ ineligible querystring subscription is free (6287ms)
        ✓ ineligible querystring subscription is in free trial (8626ms)
    returns
      ✓ object (10328ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ object (233ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1581ms)
        ✓ ineligible posted payment method (1814ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (225ms)
        ✓ invalid posted paymentmethodid (235ms)
    object
      ✓ object (1776ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (242ms)
    receives
      ✓ optionally-required posted name (414ms)
      ✓ optionally-required posted cvc (213ms)
      ✓ optionally-required posted number (243ms)
      ✓ optionally-required posted exp_month (223ms)
      ✓ optionally-required posted exp_year (233ms)
      ✓ optionally-required posted token (237ms)
    returns
      ✓ object (1764ms)
    configuration
      ✓ environment STRIPE_JS (246ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (10689ms)
        ✓ ineligible querystring charge has refund request (10697ms)
      invalid-account
        ✓ ineligible accessing account (7900ms)
    returns
      ✓ object (8941ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (9363ms)
        ✓ ineligible querystring charge is out of refund period (7889ms)
      invalid-account
        ✓ ineligible accessing account (12309ms)
    returns
      ✓ object (8514ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (8841ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1630ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (238ms)
        ✓ invalid posted paymentmethodid (222ms)
    returns
      ✓ object (1731ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (537ms)
        ✓ invalid querystring customerid (886ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (899ms)
      invalid-account
        ✓ ineligible accessing account (1092ms)
      invalid-planid
        ✓ missing posted planid (1784ms)
        ✓ invalid posted planid (1668ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2334ms)
        ✓ ineligible posted plan is unpublished (2885ms)
    returns
      ✓ object (4368ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (7559ms)
      invalid-account
        ✓ ineligible accessing account (5456ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (5513ms)
        ✓ invalid posted quantity is negative (5343ms)
      invalid-action
        ✓ missing posted action (5411ms)
        ✓ invalid posted action (5735ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (5570ms)
        ✓ invalid posted subscriptionitemid (5254ms)
    receives
      ✓ required posted quantity (6823ms)
      ✓ required posted action (5827ms)
      ✓ required posted subscriptionitemid (6294ms)
    returns
      ✓ object (6124ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (2326ms)
    returns
      ✓ object (1931ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (40ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (287ms)
    returns
      ✓ boolean (458ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7354ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9481ms)
    returns
      ✓ boolean (7951ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (7989ms)
    returns
      ✓ object (8286ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (20781ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (2938ms)
    returns
      ✓ object (1911ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (6873ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (44ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (2455ms)
    returns
      ✓ object (1723ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (5378ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (316ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (904ms)
    returns
      ✓ object (838ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1301ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (124ms)
      invalid-product
        ✓ ineligible querystring product is not published (340ms)
    returns
      ✓ object (337ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (567ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (730ms)
        ✓ invalid querystring refundid (646ms)
      invalid-account
        ✓ ineligible accessing account (11483ms)
    returns
      ✓ object (9446ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (25868ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (7322ms)
      invalid-account
        ✓ ineligible accessing account (8293ms)
    returns
      ✓ object (9184ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (219ms)
        ✓ invalid querystring customerid (211ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (1206ms)
      invalid-account
        ✓ ineligible account accessing (433ms)
      invalid-couponid
        ✓ missing posted couponid (241ms)
        ✓ invalid posted couponid (239ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (743ms)
        ✓ invalid posted coupon is unpublished (757ms)
    returns
      ✓ object (839ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2443ms)
        ✓ ineligible posted payment method (7431ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8108ms)
        ✓ invalid querystring invoice is marked uncollectable (5370ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2282ms)
        ✓ invalid posted paymentmethodid (2566ms)
    returns
      ✓ object (6263ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (1942ms)
    returns
      ✓ object (2161ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1741ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1726ms)
    returns
      ✓ object (3330ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3059ms)
    returns
      ✓ object (3120ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (9565ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9237ms)
    returns
      ✓ object (7575ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (8632ms)
        ✓ invalid querystring subscription is canceling (8639ms)
      invalid-account
        ✓ ineligible accessing account (7361ms)
      invalid-couponid
        ✓ missing posted couponid (8002ms)
        ✓ invalid posted couponid (9160ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (7600ms)
        ✓ invalid posted coupon is unpublished (8510ms)
        ✓ invalid posted coupon is other currency (9111ms)
    returns
      ✓ object (7978ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14532ms)
      invalid-planid
        ✓ missing posted planid (7204ms)
        ✓ invalid posted planid (7780ms)
      invalid-plan
        ✓ invalid posted plan is not published (8345ms)
        ✓ invalid posted plan is unpublished (8408ms)
        ✓ invalid posted plan is unchanged (7496ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (6860ms)
    returns
      ✓ object (10073ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7400ms)
      invalid-quantity
        ✓ invalid posted quantity (7613ms)
        ✓ invalid posted quantity is unchanged (6669ms)
        ✓ invalid posted quantity is negative (7997ms)
        ✓ invalid posted quantity is zero (7331ms)
    returns
      ✓ object (7947ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7558ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (6923ms)
        ✓ invalid posted tax_percent is unchanged (7672ms)
        ✓ invalid posted tax_percent is negative (6966ms)
    returns
      ✓ object (8239ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3521ms)
    returns
      ✓ object (2798ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (4503ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (13465ms)
    returns
      ✓ object (7120ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ integer (12905ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (40ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (15113ms)
      invalid-subscription
        ✓ ineligible querystring subscription (14641ms)
    returns
      ✓ object (8002ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

