

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/bind-stripekey
    after
      ✓ should bind data to req (57ms)

  server/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (6386ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (13482ms)
      ✓ should ignore user without pending confirmation (8071ms)
      ✓ should require user confirm payment (6286ms)

  server/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2226ms)
      ✓ should ignore administrator with amount owed requesting administration pages (1927ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (5287ms)
      ✓ should require user pay overdue invoice (4882ms)

  server/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages
      ✓ should ignore administrator without subscription requesting administration pages (41ms)
      ✓ should ignore user with active subscription (8062ms)
      ✓ should require user create subscription (60ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (1035ms)
      ✓ should present the form for stripe.js v3 (1724ms)
    submit
      ✓ should require name for no stripe.js (6142ms)
      ✓ should require CVC for no stripe.js (6252ms)
      ✓ should require card number for no stripe.js (6064ms)
      ✓ should require expiration month for no stripe.js (6234ms)
      ✓ should require expiration year for no stripe.js (6199ms)
      ✓ should add payment information no stripe.js (screenshots) (69103ms)
      ✓ should add payment information stripe.js v3 (20994ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (224ms)
      ✓ should reject other account's customer (237ms)
      ✓ should bind data to req (201ms)
    view
      ✓ should have row for customer (screenshots) (20339ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (6415ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (172ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (683ms)
      ✓ should present the form for stripe.js v3 (1423ms)
    submit
      ✓ should require description for no stripe.js (6912ms)
      ✓ should require email for no stripe.js (6518ms)
      ✓ should require name for no stripe.js (6833ms)
      ✓ should require CVC for no stripe.js (7355ms)
      ✓ should require card number for no stripe.js (6684ms)
      ✓ should require expiration month for no stripe.js (7183ms)
      ✓ should require expiration year for no stripe.js (7133ms)
      ✓ should require description for stripe.js v3 (18701ms)
      ✓ should require email for stripe.js v3 (18286ms)
      ✓ should create billing profile for no stripe.js (8740ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (109698ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (144ms)
      ✓ should reject never published plan (712ms)
      ✓ should reject unpublished plan (886ms)
      ✓ should bind data to req (707ms)
    view
      ✓ should have row for plan (screenshots) (20158ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (928ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (187ms)
      ✓ should reject customer with coupon (1939ms)
    before
      ✓ should bind data to req (813ms)
    view
      ✓ should present the form (1332ms)
    submit
      ✓ should apply coupon (screenshots) (37833ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (148ms)
      ✓ should reject canceling subscription (8370ms)
      ✓ should reject free subscription (5372ms)
      ✓ should reject subscription with coupon (9503ms)
    before
      ✓ should bind data to req (7659ms)
    view
      ✓ should present the form (7824ms)
    submit
      ✓ should apply coupon (screenshots) (44836ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (924ms)
      ✓ should bind data to req (7094ms)
    view
      ✓ should present the charge table (screenshots) (30914ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (149ms)
      ✓ should bind data to req (320ms)
    view
      ✓ should present the coupon table (screenshots) (23903ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (561ms)
    submit
      ✓ should reject missing couponid (1373ms)
      ✓ should enforce couponid length (2230ms)
      ✓ should reject duplicate couponid (2093ms)
      ✓ should reject missing duration (1725ms)
      ✓ should enforce invalid duration (1754ms)
      ✓ should require valid amount off (1896ms)
      ✓ should require valid percent off (1741ms)
      ✓ should require valid max redemptions (1711ms)
      ✓ should require amount or percent off (1613ms)
      ✓ should require valid duration in months if repeating (1855ms)
      ✓ should require valid redeem_by if provided (2056ms)
      ✓ should create coupon (screenshots) (30639ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (808ms)
    submit
      ✓ should reject missing planid (1785ms)
      ✓ should enforce planid length (2652ms)
      ✓ should reject missing productid (1696ms)
      ✓ should reject never published product (2150ms)
      ✓ should reject unpublished product (2126ms)
      ✓ should reject missing currency (2074ms)
      ✓ should reject invalid currency (2069ms)
      ✓ should reject missing usage_type (2029ms)
      ✓ should reject missing amount (2002ms)
      ✓ should reject invalid amount (2093ms)
      ✓ should reject missing interval (2114ms)
      ✓ should reject invalid interval (2082ms)
      ✓ should reject invalid interval_count (2068ms)
      ✓ should reject invalid trial_period_days (2235ms)
      ✓ should create plan (screenshots) (30706ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (473ms)
    submit
      ✓ should reject missing name (1290ms)
      ✓ should enforce name length (2197ms)
      ✓ should reject missing statement_descriptor (1221ms)
      ✓ should create product (screenshots) (29748ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (370ms)
      ✓ should bind data to req (222ms)
    view
      ✓ should present the customer table (screenshots) (19901ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (151ms)
    before
      ✓ should bind data to req (304ms)
    view
      ✓ should present the form (780ms)
    submit
      ✓ should delete coupon (screenshots) (36509ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (146ms)
    before
      ✓ should bind data to req (687ms)
    view
      ✓ should present the form (1326ms)
    submit
      ✓ should delete plan (screenshots) (36886ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (159ms)
    before
      ✓ should bind data to req (313ms)
    view
      ✓ should present the form (794ms)
    submit
      ✓ should delete product (screenshots) (35025ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5030ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (157ms)
      ✓ should reject charge without refund request (8382ms)
      ✓ should reject denied refund (8286ms)
    before
      ✓ should bind data to req (7388ms)
    view
      ✓ should present the form (8529ms)
    submit
      ✓ should deny refund (screenshots) (48474ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (619ms)
      ✓ should bind data to req (294ms)
    view
      ✓ should present the form (765ms)
    submit
      ✓ should reject missing name (1290ms)
      ✓ should update coupon (screenshots) (36659ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (175ms)
      ✓ should reject unpublished plan (1030ms)
      ✓ should bind data to req (1005ms)
    view
      ✓ should present the form (1273ms)
    submit
      ✓ should reject missing productid (2147ms)
      ✓ should reject invalid trial period (2642ms)
      ✓ should update plan (screenshots) (39288ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (144ms)
      ✓ should reject unpublished product (471ms)
      ✓ should bind data to req (332ms)
    view
      ✓ should present the form (744ms)
    submit
      ✓ should reject missing name (1546ms)
      ✓ should enforce name length (2455ms)
      ✓ should reject missing statement_descriptor (1475ms)
      ✓ should reject invalid unit_label (1843ms)
      ✓ should update product (screenshots) (39217ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (159ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (138ms)
      ✓ should reject paid invoice (10270ms)
      ✓ should reject uncollectible invoice (2566ms)
    before
      ✓ should bind data to req (2446ms)
    view
      ✓ should present the form (3041ms)
    submit
      ✓ should forgive invoice (screenshots) (36890ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (7396ms)
    view
      ✓ should have row for each plan (1597ms)
      ✓ should have row for each coupon (1152ms)
      ✓ should have row for each subscription (screenshots) (23982ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (140ms)
      ✓ should bind data to req (6965ms)
    view
      ✓ should present the invoice table (screenshots) (30367ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (1656ms)
    view
      ✓ should have row for payment intent (screenshots) (24983ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (1497ms)
    view
      ✓ should have row for payment method (screenshots) (25224ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (178ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (155ms)
      ✓ should bind data to req (603ms)
    view
      ✓ should present the plan table (screenshots) (24337ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (151ms)
      ✓ should bind data to req (287ms)
    view
      ✓ should have row for product (screenshots) (22469ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (225ms)
      ✓ should reject published coupon (376ms)
    before
      ✓ should bind data to req (323ms)
    view
      ✓ should present the form (762ms)
    submit
      ✓ should publish coupon (screenshots) (36087ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (169ms)
      ✓ should reject published plan (628ms)
    before
      ✓ should bind data to req (640ms)
    view
      ✓ should present the form (1199ms)
    submit
      ✓ should publish plan (screenshots) (36505ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (196ms)
      ✓ should reject published product (356ms)
    before
      ✓ should bind data to req (323ms)
    view
      ✓ should present the form (825ms)
    submit
      ✓ should publish product (screenshots) (34725ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (151ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (170ms)
      ✓ should bind data to req (9489ms)
    view
      ✓ should have row for refund (screenshots) (33572ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (158ms)
      ✓ should reject customer without discount (898ms)
    before
      ✓ should bind data to req (1255ms)
    view
      ✓ should present the form (2060ms)
    submit
      ✓ should remove coupon (screenshots) (34562ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (148ms)
      ✓ should reject subscription without discount (8514ms)
    before
      ✓ should bind data to req (9898ms)
    view
      ✓ should present the form (11101ms)
    submit
      ✓ should remove coupon (screenshots) (44348ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (2519ms)
    view
      ✓ should have row for setup intent (screenshots) (28896ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (149ms)
      ✓ should bind data to req (9367ms)
    view
      ✓ should present the subscription table (screenshots) (29179ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (155ms)
      ✓ should reject never published coupon (301ms)
      ✓ should reject unpublished coupon (494ms)
    before
      ✓ should bind data to req (330ms)
    view
      ✓ should present the form (778ms)
    submit
      ✓ should unpublish coupon (screenshots) (36079ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (166ms)
      ✓ should never published plan (657ms)
      ✓ should reject unpublished plan (836ms)
    before
      ✓ should bind data to req (672ms)
    view
      ✓ should present the form (1123ms)
    submit
      ✓ should unpublish plan (screenshots) (36358ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (149ms)
      ✓ should never published product (310ms)
      ✓ should reject unpublished product (429ms)
    before
      ✓ should bind data to req (275ms)
    view
      ✓ should present the form (876ms)
    submit
      ✓ should unpublish product (screenshots) (34748ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (173ms)
    returns
      ✓ object (7031ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (24099ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (141ms)
    returns
      ✓ object (306ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (494ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (154ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8014ms)
    returns
      ✓ object (9746ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (180ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (180ms)
      invalid-planid-length
        ✓ posted planid is too short (185ms)
        ✓ posted planid is too long (163ms)
      invalid-productid
        ✓ missing posted productid (190ms)
        ✓ invalid posted productid (325ms)
      invalid-product
        ✓ ineligible posted product is not published (284ms)
      invalid-amount
        ✓ missing posted amount (292ms)
        ✓ invalid posted amount (307ms)
      invalid-currency
        ✓ missing posted currency (170ms)
        ✓ invalid posted currency (169ms)
      invalid-interval
        ✓ missing posted interval (294ms)
        ✓ invalid posted interval (300ms)
      invalid-interval-count
        ✓ missing posted interval_count (319ms)
        ✓ invalid posted interval_count (327ms)
      invalid-trial_period
        ✓ invalid posted trial_period (306ms)
      invalid-usage_type
        ✓ invalid posted usage_type (334ms)
    receives
      ✓ optional posted published (boolean) (518ms)
      ✓ optional posted trial_period_days (integer) (524ms)
      ✓ optional posted usage_type (licensed|metered) (498ms)
    returns
      ✓ object (502ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (178ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (174ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (330ms)
    returns
      ✓ object (308ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (211ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (163ms)
    returns
      ✓ object (3237ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (639ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (161ms)
    returns
      ✓ boolean (583ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (243ms)
    returns
      ✓ boolean (842ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (143ms)
    returns
      ✓ boolean (480ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (152ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (10117ms)
    returns
      ✓ boolean (8180ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (159ms)
    returns
      ✓ object (7899ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (35936ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (1915ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5187ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1683ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (6230ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (142ms)
    returns
      ✓ object (624ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (1166ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (156ms)
    returns
      ✓ object (289ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (482ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (22861ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (179ms)
    returns
      ✓ object (8839ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (29647ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (152ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (238ms)
    receives
      ✓ object (1030ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (152ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (7546ms)
    returns
      ✓ object (9743ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (170ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (7990ms)
    returns
      ✓ object (8740ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (182ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (306ms)
        ✓ ineligible querystring coupon is unpublished (343ms)
    returns
      ✓ object (542ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (146ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (312ms)
        ✓ ineligible querystring coupon is already unpublished (682ms)
    returns
      ✓ object (496ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (155ms)
        ✓ invalid querystring invoiceid (144ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (7780ms)
        ✓ invalid querystring invoice is marked uncollectable (4757ms)
    returns
      ✓ object (5195ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (146ms)
      invalid-plan
        ✓ ineligible querystring plan is published (649ms)
    returns
      ✓ object (885ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (195ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (633ms)
        ✓ ineligible querystring plan is already unpublished (849ms)
    returns
      ✓ object (895ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (312ms)
        ✓ invalid querystring productid (348ms)
      invalid-product
        ✓ invalid querystring product is already published (300ms)
    returns
      ✓ object (498ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (183ms)
        ✓ invalid querystring productid (304ms)
      invalid-product
        ✓ ineligible querystring product is not published (306ms)
        ✓ ineligible querystring product is already unpublished (546ms)
    returns
      ✓ object (482ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (163ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (7538ms)
        ✓ ineligible querystring charge has denied request already (8933ms)
    returns
      ✓ object (8442ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (146ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9385ms)
    returns
      ✓ object (9122ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (8706ms)
        ✓ ineligible subscription has coupon (19793ms)
      invalid-couponid
        ✓ missing posted couponid (7439ms)
        ✓ invalid posted couponid (6447ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (7046ms)
        ✓ ineligible posted coupon is unpublished (7147ms)
    returns
      ✓ object (8202ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
    returns
      ✓ object (2542ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4391ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (161ms)
    returns
      ✓ object (6798ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (25509ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (146ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (488ms)
      invalid-name
        ✓ missing posted name (512ms)
        ✓ invalid posted name (287ms)
    receives
      ✓ required posted name (453ms)
    returns
      ✓ object (476ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (166ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (1134ms)
      invalid-productid
        ✓ invalid posted productid (785ms)
      invalid-product
        ✓ ineligible posted product is not published (908ms)
        ✓ ineligible posted product is unpublished (1091ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (1076ms)
        ✓ ineligible posted trial_period_days is negative (1032ms)
        ✓ ineligible posted trial_period_days greater than 365 (921ms)
    receives
      ✓ optional posted trial_period_days (integer) (826ms)
    returns
      ✓ object (1115ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (179ms)
        ✓ invalid querystring productid (286ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (629ms)
      invalid-name
        ✓ invalid posted name (287ms)
      invalid-name-length
        ✓ posted name too short (301ms)
        ✓ posted name too long (336ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (306ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (299ms)
        ✓ posted statement_descriptor too long (289ms)
      invalid-unit_label
        ✓ missing posted unit_label (292ms)
    receives
      ✓ optional posted name (450ms)
      ✓ optional posted statement_descriptor (627ms)
      ✓ optional posted unit_label (542ms)
    returns
      ✓ object (467ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (457ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (290ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (13038ms)
    returns
      ✓ object (8121ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (18322ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (41ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (6836ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9093ms)
        ✓ ineligible querystring subscription is free (7435ms)
        ✓ ineligible querystring subscription is in free trial (6265ms)
    returns
      ✓ object (8502ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (39ms)
    returns
      ✓ object (214ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1719ms)
        ✓ ineligible posted payment method (1690ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (197ms)
        ✓ invalid posted paymentmethodid (230ms)
    object
      ✓ object (2080ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (242ms)
    receives
      ✓ optionally-required posted name (409ms)
      ✓ optionally-required posted cvc (214ms)
      ✓ optionally-required posted number (220ms)
      ✓ optionally-required posted exp_month (239ms)
      ✓ optionally-required posted exp_year (219ms)
      ✓ optionally-required posted token (199ms)
    returns
      ✓ object (1691ms)
    configuration
      ✓ environment STRIPE_JS (272ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (8898ms)
        ✓ ineligible querystring charge has refund request (8208ms)
      invalid-account
        ✓ ineligible accessing account (7739ms)
    returns
      ✓ object (7481ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (9222ms)
        ✓ ineligible querystring charge is out of refund period (7824ms)
      invalid-account
        ✓ ineligible accessing account (7641ms)
    returns
      ✓ object (9343ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (8396ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1442ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (210ms)
        ✓ invalid posted paymentmethodid (207ms)
    returns
      ✓ object (1779ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (702ms)
        ✓ invalid querystring customerid (705ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (878ms)
      invalid-account
        ✓ ineligible accessing account (874ms)
      invalid-planid
        ✓ missing posted planid (1621ms)
        ✓ invalid posted planid (1766ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2601ms)
        ✓ ineligible posted plan is unpublished (2635ms)
    returns
      ✓ object (4230ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (7268ms)
      invalid-account
        ✓ ineligible accessing account (5302ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (9184ms)
        ✓ invalid posted quantity is negative (4896ms)
      invalid-action
        ✓ missing posted action (5199ms)
        ✓ invalid posted action (5336ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (13878ms)
        ✓ invalid posted subscriptionitemid (7501ms)
    receives
      ✓ required posted quantity (11446ms)
      ✓ required posted action (5135ms)
      ✓ required posted subscriptionitemid (5327ms)
    returns
      ✓ object (5008ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1570ms)
    returns
      ✓ object (1515ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (239ms)
    returns
      ✓ boolean (444ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (6735ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8021ms)
    returns
      ✓ boolean (7288ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (7470ms)
    returns
      ✓ object (7278ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (17003ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (39ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (1957ms)
    returns
      ✓ object (1768ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (5235ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (39ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1862ms)
    returns
      ✓ object (1658ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (4005ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (51ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (137ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (843ms)
    returns
      ✓ object (674ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1204ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (121ms)
      invalid-product
        ✓ ineligible querystring product is not published (306ms)
    returns
      ✓ object (338ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (356ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (613ms)
        ✓ invalid querystring refundid (580ms)
      invalid-account
        ✓ ineligible accessing account (11461ms)
    returns
      ✓ object (10434ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (22968ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (39ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (7414ms)
      invalid-account
        ✓ ineligible accessing account (7651ms)
    returns
      ✓ object (8389ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (206ms)
        ✓ invalid querystring customerid (199ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (986ms)
      invalid-account
        ✓ ineligible account accessing (414ms)
      invalid-couponid
        ✓ missing posted couponid (215ms)
        ✓ invalid posted couponid (223ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (574ms)
        ✓ invalid posted coupon is unpublished (855ms)
    returns
      ✓ object (935ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2263ms)
        ✓ ineligible posted payment method (6760ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (7606ms)
        ✓ invalid querystring invoice is marked uncollectable (5089ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2927ms)
        ✓ invalid posted paymentmethodid (6616ms)
    returns
      ✓ object (5818ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (1666ms)
    returns
      ✓ object (2218ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1393ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1874ms)
    returns
      ✓ object (3157ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3945ms)
    returns
      ✓ object (3266ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (8573ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8620ms)
    returns
      ✓ object (8762ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (8830ms)
        ✓ invalid querystring subscription is canceling (13714ms)
      invalid-account
        ✓ ineligible accessing account (7021ms)
      invalid-couponid
        ✓ missing posted couponid (7505ms)
        ✓ invalid posted couponid (7324ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (8252ms)
        ✓ invalid posted coupon is unpublished (8427ms)
        ✓ invalid posted coupon is other currency (6794ms)
    returns
      ✓ object (11986ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14071ms)
      invalid-planid
        ✓ missing posted planid (7958ms)
        ✓ invalid posted planid (7861ms)
      invalid-plan
        ✓ invalid posted plan is not published (8938ms)
        ✓ invalid posted plan is unpublished (8015ms)
        ✓ invalid posted plan is unchanged (7209ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (6098ms)
    returns
      ✓ object (8629ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7806ms)
      invalid-quantity
        ✓ invalid posted quantity (7880ms)
        ✓ invalid posted quantity is unchanged (8093ms)
        ✓ invalid posted quantity is negative (7393ms)
        ✓ invalid posted quantity is zero (7341ms)
    returns
      ✓ object (7367ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7767ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (9145ms)
        ✓ invalid posted tax_percent is unchanged (8515ms)
        ✓ invalid posted tax_percent is negative (7622ms)
    returns
      ✓ object (7453ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3587ms)
    returns
      ✓ object (3793ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (4580ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (40ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (13117ms)
    returns
      ✓ object (7511ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (44ms)
    returns
      ✓ integer (11546ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (13789ms)
      invalid-subscription
        ✓ ineligible querystring subscription (13131ms)
    returns
      ✓ object (7001ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

