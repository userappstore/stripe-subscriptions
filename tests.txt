

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/bind-stripekey
    after
      ✓ should bind data to req (61ms)

  server/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (13045ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (7493ms)
      ✓ should ignore user without pending confirmation (7835ms)
      ✓ should require user confirm payment (7310ms)

  server/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2510ms)
      ✓ should ignore administrator with amount owed requesting administration pages (2174ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (7292ms)
      ✓ should require user pay overdue invoice (5798ms)

  server/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages
      ✓ should ignore administrator without subscription requesting administration pages
      ✓ should ignore user with active subscription (7564ms)
      ✓ should require user create subscription (55ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (3587ms)
      ✓ should present the form for stripe.js v3 (2384ms)
    submit
      ✓ should require name for no stripe.js (6082ms)
      ✓ should require CVC for no stripe.js (6141ms)
      ✓ should require card number for no stripe.js (5820ms)
      ✓ should require expiration month for no stripe.js (6178ms)
      ✓ should require expiration year for no stripe.js (6160ms)
      ✓ should add payment information no stripe.js (screenshots) (70761ms)
      ✓ should add payment information stripe.js v3 (21310ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (226ms)
      ✓ should reject other account's customer (249ms)
      ✓ should bind data to req (219ms)
    view
      ✓ should have row for customer (screenshots) (21183ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (6508ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (174ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (668ms)
      ✓ should present the form for stripe.js v3 (1436ms)
    submit
      ✓ should require description for no stripe.js (7060ms)
      ✓ should require email for no stripe.js (6509ms)
      ✓ should require name for no stripe.js (6832ms)
      ✓ should require CVC for no stripe.js (7493ms)
      ✓ should require card number for no stripe.js (6612ms)
      ✓ should require expiration month for no stripe.js (7095ms)
      ✓ should require expiration year for no stripe.js (7170ms)
      ✓ should require description for stripe.js v3 (18662ms)
      ✓ should require email for stripe.js v3 (18509ms)
      ✓ should create billing profile for no stripe.js (8782ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (112090ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (151ms)
      ✓ should reject never published plan (654ms)
      ✓ should reject unpublished plan (869ms)
      ✓ should bind data to req (642ms)
    view
      ✓ should have row for plan (screenshots) (20651ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (505ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (177ms)
      ✓ should reject customer with coupon (2020ms)
    before
      ✓ should bind data to req (781ms)
    view
      ✓ should present the form (1465ms)
    submit
      ✓ should apply coupon (screenshots) (40049ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (168ms)
      ✓ should reject canceling subscription (7827ms)
      ✓ should reject free subscription (5384ms)
      ✓ should reject subscription with coupon (10053ms)
    before
      ✓ should bind data to req (10376ms)
    view
      ✓ should present the form (13684ms)
    submit
      ✓ should apply coupon (screenshots) (45564ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (789ms)
      ✓ should bind data to req (6787ms)
    view
      ✓ should present the charge table (screenshots) (33195ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (161ms)
      ✓ should bind data to req (306ms)
    view
      ✓ should present the coupon table (screenshots) (24400ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (676ms)
    submit
      ✓ should reject missing couponid (1332ms)
      ✓ should enforce couponid length (2263ms)
      ✓ should reject duplicate couponid (2111ms)
      ✓ should reject missing duration (1772ms)
      ✓ should enforce invalid duration (1804ms)
      ✓ should require valid amount off (1864ms)
      ✓ should require valid percent off (1759ms)
      ✓ should require valid max redemptions (1771ms)
      ✓ should require amount or percent off (1631ms)
      ✓ should require valid duration in months if repeating (1891ms)
      ✓ should require valid redeem_by if provided (2086ms)
      ✓ should create coupon (screenshots) (31413ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (825ms)
    submit
      ✓ should reject missing planid (1903ms)
      ✓ should enforce planid length (2740ms)
      ✓ should reject missing productid (1736ms)
      ✓ should reject never published product (2167ms)
      ✓ should reject unpublished product (2142ms)
      ✓ should reject missing currency (2125ms)
      ✓ should reject invalid currency (2119ms)
      ✓ should reject missing usage_type (2112ms)
      ✓ should reject missing amount (2254ms)
      ✓ should reject invalid amount (2081ms)
      ✓ should reject missing interval (2127ms)
      ✓ should reject invalid interval (2159ms)
      ✓ should reject invalid interval_count (2131ms)
      ✓ should reject invalid trial_period_days (2261ms)
      ✓ should create plan (screenshots) (32140ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (496ms)
    submit
      ✓ should reject missing name (1325ms)
      ✓ should enforce name length (2283ms)
      ✓ should reject missing statement_descriptor (1264ms)
      ✓ should create product (screenshots) (31177ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (447ms)
      ✓ should bind data to req (230ms)
    view
      ✓ should present the customer table (screenshots) (20708ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (146ms)
    before
      ✓ should bind data to req (324ms)
    view
      ✓ should present the form (829ms)
    submit
      ✓ should delete coupon (screenshots) (37659ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (158ms)
    before
      ✓ should bind data to req (684ms)
    view
      ✓ should present the form (1184ms)
    submit
      ✓ should delete plan (screenshots) (38123ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (224ms)
    before
      ✓ should bind data to req (294ms)
    view
      ✓ should present the form (787ms)
    submit
      ✓ should delete product (screenshots) (36412ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5183ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (172ms)
      ✓ should reject charge without refund request (12710ms)
      ✓ should reject denied refund (7958ms)
    before
      ✓ should bind data to req (7621ms)
    view
      ✓ should present the form (9988ms)
    submit
      ✓ should deny refund (screenshots) (51527ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (483ms)
      ✓ should bind data to req (316ms)
    view
      ✓ should present the form (798ms)
    submit
      ✓ should reject missing name (1387ms)
      ✓ should update coupon (screenshots) (37656ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (146ms)
      ✓ should reject unpublished plan (904ms)
      ✓ should bind data to req (760ms)
    view
      ✓ should present the form (1258ms)
    submit
      ✓ should reject missing productid (1946ms)
      ✓ should reject invalid trial period (2631ms)
      ✓ should update plan (screenshots) (39697ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (190ms)
      ✓ should reject unpublished product (503ms)
      ✓ should bind data to req (299ms)
    view
      ✓ should present the form (803ms)
    submit
      ✓ should reject missing name (1594ms)
      ✓ should enforce name length (2466ms)
      ✓ should reject missing statement_descriptor (1540ms)
      ✓ should reject invalid unit_label (1878ms)
      ✓ should update product (screenshots) (40561ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (156ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (149ms)
      ✓ should reject paid invoice (7247ms)
      ✓ should reject uncollectible invoice (3890ms)
    before
      ✓ should bind data to req (2670ms)
    view
      ✓ should present the form (2585ms)
    submit
      ✓ should forgive invoice (screenshots) (36930ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (7278ms)
    view
      ✓ should have row for each plan (1957ms)
      ✓ should have row for each coupon (1102ms)
      ✓ should have row for each subscription (screenshots) (24855ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (161ms)
      ✓ should bind data to req (7183ms)
    view
      ✓ should present the invoice table (screenshots) (30666ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (1746ms)
    view
      ✓ should have row for payment intent (screenshots) (26018ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (1700ms)
    view
      ✓ should have row for payment method (screenshots) (26004ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (172ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (162ms)
      ✓ should bind data to req (703ms)
    view
      ✓ should present the plan table (screenshots) (24610ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (166ms)
      ✓ should bind data to req (328ms)
    view
      ✓ should have row for product (screenshots) (23165ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (147ms)
      ✓ should reject published coupon (334ms)
    before
      ✓ should bind data to req (306ms)
    view
      ✓ should present the form (814ms)
    submit
      ✓ should publish coupon (screenshots) (37143ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (155ms)
      ✓ should reject published plan (652ms)
    before
      ✓ should bind data to req (679ms)
    view
      ✓ should present the form (1172ms)
    submit
      ✓ should publish plan (screenshots) (37525ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (155ms)
      ✓ should reject published product (330ms)
    before
      ✓ should bind data to req (287ms)
    view
      ✓ should present the form (780ms)
    submit
      ✓ should publish product (screenshots) (35837ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (173ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (164ms)
      ✓ should bind data to req (8578ms)
    view
      ✓ should have row for refund (screenshots) (33248ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (150ms)
      ✓ should reject customer without discount (919ms)
    before
      ✓ should bind data to req (1322ms)
    view
      ✓ should present the form (1791ms)
    submit
      ✓ should remove coupon (screenshots) (35795ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (166ms)
      ✓ should reject subscription without discount (8549ms)
    before
      ✓ should bind data to req (8522ms)
    view
      ✓ should present the form (9827ms)
    submit
      ✓ should remove coupon (screenshots) (47626ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (3683ms)
    view
      ✓ should have row for setup intent (screenshots) (27099ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (162ms)
      ✓ should bind data to req (8795ms)
    view
      ✓ should present the subscription table (screenshots) (30739ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (162ms)
      ✓ should reject never published coupon (304ms)
      ✓ should reject unpublished coupon (497ms)
    before
      ✓ should bind data to req (304ms)
    view
      ✓ should present the form (827ms)
    submit
      ✓ should unpublish coupon (screenshots) (36974ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (135ms)
      ✓ should never published plan (661ms)
      ✓ should reject unpublished plan (873ms)
    before
      ✓ should bind data to req (647ms)
    view
      ✓ should present the form (1099ms)
    submit
      ✓ should unpublish plan (screenshots) (37539ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (137ms)
      ✓ should never published product (287ms)
      ✓ should reject unpublished product (471ms)
    before
      ✓ should bind data to req (303ms)
    view
      ✓ should present the form (776ms)
    submit
      ✓ should unpublish product (screenshots) (35964ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (184ms)
    returns
      ✓ object (7170ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (24984ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (151ms)
    returns
      ✓ object (316ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (660ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (162ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8624ms)
    returns
      ✓ object (9419ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (191ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (180ms)
      invalid-planid-length
        ✓ posted planid is too short (185ms)
        ✓ posted planid is too long (165ms)
      invalid-productid
        ✓ missing posted productid (183ms)
        ✓ invalid posted productid (323ms)
      invalid-product
        ✓ ineligible posted product is not published (303ms)
      invalid-amount
        ✓ missing posted amount (319ms)
        ✓ invalid posted amount (313ms)
      invalid-currency
        ✓ missing posted currency (189ms)
        ✓ invalid posted currency (194ms)
      invalid-interval
        ✓ missing posted interval (454ms)
        ✓ invalid posted interval (310ms)
      invalid-interval-count
        ✓ missing posted interval_count (312ms)
        ✓ invalid posted interval_count (301ms)
      invalid-trial_period
        ✓ invalid posted trial_period (310ms)
      invalid-usage_type
        ✓ invalid posted usage_type (296ms)
    receives
      ✓ optional posted published (boolean) (531ms)
      ✓ optional posted trial_period_days (integer) (588ms)
      ✓ optional posted usage_type (licensed|metered) (543ms)
    returns
      ✓ object (533ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (200ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (187ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (331ms)
    returns
      ✓ object (323ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (174ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (183ms)
    returns
      ✓ object (2822ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (423ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (164ms)
    returns
      ✓ boolean (476ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (162ms)
    returns
      ✓ boolean (879ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (140ms)
    returns
      ✓ boolean (504ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (163ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8518ms)
    returns
      ✓ boolean (10393ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (140ms)
    returns
      ✓ object (6492ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (29616ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (1966ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5078ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1450ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (4186ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (172ms)
    returns
      ✓ object (781ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (1436ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (141ms)
    returns
      ✓ object (301ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (558ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (23606ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (150ms)
    returns
      ✓ object (8734ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (26153ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (155ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (240ms)
    receives
      ✓ object (1153ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (151ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (9732ms)
    returns
      ✓ object (8484ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (155ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (7943ms)
    returns
      ✓ object (7048ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (302ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (314ms)
        ✓ ineligible querystring coupon is unpublished (312ms)
    returns
      ✓ object (497ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (137ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (332ms)
        ✓ ineligible querystring coupon is already unpublished (518ms)
    returns
      ✓ object (518ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (154ms)
        ✓ invalid querystring invoiceid (136ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (9989ms)
        ✓ invalid querystring invoice is marked uncollectable (5196ms)
    returns
      ✓ object (4686ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (158ms)
      invalid-plan
        ✓ ineligible querystring plan is published (717ms)
    returns
      ✓ object (877ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (173ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (787ms)
        ✓ ineligible querystring plan is already unpublished (938ms)
    returns
      ✓ object (816ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (324ms)
        ✓ invalid querystring productid (298ms)
      invalid-product
        ✓ invalid querystring product is already published (293ms)
    returns
      ✓ object (486ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (181ms)
        ✓ invalid querystring productid (303ms)
      invalid-product
        ✓ ineligible querystring product is not published (295ms)
        ✓ ineligible querystring product is already unpublished (644ms)
    returns
      ✓ object (510ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid (66ms)
        ✓ invalid querystring chargeid (152ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (6677ms)
        ✓ ineligible querystring charge has denied request already (7185ms)
    returns
      ✓ object (7097ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (307ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (7846ms)
    returns
      ✓ object (7877ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (11738ms)
        ✓ ineligible subscription has coupon (11146ms)
      invalid-couponid
        ✓ missing posted couponid (7322ms)
        ✓ invalid posted couponid (6977ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (7915ms)
        ✓ ineligible posted coupon is unpublished (10544ms)
    returns
      ✓ object (8297ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
    returns
      ✓ object (2802ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4244ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (162ms)
    returns
      ✓ object (7823ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (26005ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (137ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (638ms)
      invalid-name
        ✓ missing posted name (318ms)
        ✓ invalid posted name (340ms)
    receives
      ✓ required posted name (626ms)
    returns
      ✓ object (533ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (165ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (1026ms)
      invalid-productid
        ✓ invalid posted productid (764ms)
      invalid-product
        ✓ ineligible posted product is not published (921ms)
        ✓ ineligible posted product is unpublished (1191ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (1084ms)
        ✓ ineligible posted trial_period_days is negative (1255ms)
        ✓ ineligible posted trial_period_days greater than 365 (975ms)
    receives
      ✓ optional posted trial_period_days (integer) (849ms)
    returns
      ✓ object (1286ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (172ms)
        ✓ invalid querystring productid (309ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (503ms)
      invalid-name
        ✓ invalid posted name (306ms)
      invalid-name-length
        ✓ posted name too short (309ms)
        ✓ posted name too long (300ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (310ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (303ms)
        ✓ posted statement_descriptor too long (310ms)
      invalid-unit_label
        ✓ missing posted unit_label (314ms)
    receives
      ✓ optional posted name (450ms)
      ✓ optional posted statement_descriptor (467ms)
      ✓ optional posted unit_label (503ms)
    returns
      ✓ object (498ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (324ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (315ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid (55ms)
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (11038ms)
    returns
      ✓ object (9028ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (16004ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (42ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7515ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8165ms)
        ✓ ineligible querystring subscription is free (6522ms)
        ✓ ineligible querystring subscription is in free trial (8584ms)
    returns
      ✓ object (9285ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ object (218ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1411ms)
        ✓ ineligible posted payment method (1755ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (210ms)
        ✓ invalid posted paymentmethodid (207ms)
    object
      ✓ object (2131ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (241ms)
    receives
      ✓ optionally-required posted name (207ms)
      ✓ optionally-required posted cvc (202ms)
      ✓ optionally-required posted number (221ms)
      ✓ optionally-required posted exp_month (216ms)
      ✓ optionally-required posted exp_year (216ms)
      ✓ optionally-required posted token (232ms)
    returns
      ✓ object (1411ms)
    configuration
      ✓ environment STRIPE_JS (252ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (11232ms)
        ✓ ineligible querystring charge has refund request (8752ms)
      invalid-account
        ✓ ineligible accessing account (8956ms)
    returns
      ✓ object (7627ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (9168ms)
        ✓ ineligible querystring charge is out of refund period (8046ms)
      invalid-account
        ✓ ineligible accessing account (7584ms)
    returns
      ✓ object (8526ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (8493ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (3220ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (220ms)
        ✓ invalid posted paymentmethodid (228ms)
    returns
      ✓ object (1593ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (527ms)
        ✓ invalid querystring customerid (663ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (1214ms)
      invalid-account
        ✓ ineligible accessing account (931ms)
      invalid-planid
        ✓ missing posted planid (1807ms)
        ✓ invalid posted planid (1831ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2125ms)
        ✓ ineligible posted plan is unpublished (2473ms)
    returns
      ✓ object (4159ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (8555ms)
      invalid-account
        ✓ ineligible accessing account (5204ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (5889ms)
        ✓ invalid posted quantity is negative (6315ms)
      invalid-action
        ✓ missing posted action (5191ms)
        ✓ invalid posted action (4716ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (5597ms)
        ✓ invalid posted subscriptionitemid (5594ms)
    receives
      ✓ required posted quantity (5711ms)
      ✓ required posted action (5784ms)
      ✓ required posted subscriptionitemid (5406ms)
    returns
      ✓ object (5254ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1688ms)
    returns
      ✓ object (1534ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (209ms)
    returns
      ✓ boolean (563ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (9725ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (10937ms)
    returns
      ✓ boolean (24802ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (7075ms)
    returns
      ✓ object (6848ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (20000ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (46ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (1678ms)
    returns
      ✓ object (1915ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (5457ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (47ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (2041ms)
    returns
      ✓ object (1412ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (3975ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (38ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (140ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (644ms)
    returns
      ✓ object (674ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1064ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (122ms)
      invalid-product
        ✓ ineligible querystring product is not published (487ms)
    returns
      ✓ object (314ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (670ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (1463ms)
        ✓ invalid querystring refundid (782ms)
      invalid-account
        ✓ ineligible accessing account (9193ms)
    returns
      ✓ object (10465ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (25126ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (43ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (7184ms)
      invalid-account
        ✓ ineligible accessing account (7898ms)
    returns
      ✓ object (8726ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (219ms)
        ✓ invalid querystring customerid (256ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (942ms)
      invalid-account
        ✓ ineligible account accessing (417ms)
      invalid-couponid
        ✓ missing posted couponid (243ms)
        ✓ invalid posted couponid (219ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (551ms)
        ✓ invalid posted coupon is unpublished (732ms)
    returns
      ✓ object (834ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2322ms)
        ✓ ineligible posted payment method (7805ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (10227ms)
        ✓ invalid querystring invoice is marked uncollectable (5722ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2156ms)
        ✓ invalid posted paymentmethodid (2144ms)
    returns
      ✓ object (5906ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (2263ms)
    returns
      ✓ object (2520ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1721ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1699ms)
    returns
      ✓ object (3544ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (2733ms)
    returns
      ✓ object (3585ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (9623ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9765ms)
    returns
      ✓ object (9255ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (10941ms)
        ✓ invalid querystring subscription is canceling (10768ms)
      invalid-account
        ✓ ineligible accessing account (9918ms)
      invalid-couponid
        ✓ missing posted couponid (8325ms)
        ✓ invalid posted couponid (8577ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (7592ms)
        ✓ invalid posted coupon is unpublished (7907ms)
        ✓ invalid posted coupon is other currency (8277ms)
    returns
      ✓ object (8406ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (15187ms)
      invalid-planid
        ✓ missing posted planid (8411ms)
        ✓ invalid posted planid (9426ms)
      invalid-plan
        ✓ invalid posted plan is not published (9501ms)
        ✓ invalid posted plan is unpublished (8251ms)
        ✓ invalid posted plan is unchanged (7632ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (6682ms)
    returns
      ✓ object (8846ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7441ms)
      invalid-quantity
        ✓ invalid posted quantity (9026ms)
        ✓ invalid posted quantity is unchanged (7468ms)
        ✓ invalid posted quantity is negative (7406ms)
        ✓ invalid posted quantity is zero (7685ms)
    returns
      ✓ object (9748ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7239ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (6919ms)
        ✓ invalid posted tax_percent is unchanged (7150ms)
        ✓ invalid posted tax_percent is negative (11209ms)
    returns
      ✓ object (7652ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3474ms)
    returns
      ✓ object (2486ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (4691ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14338ms)
    returns
      ✓ object (7928ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (47ms)
    returns
      ✓ integer (12528ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (41ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (17928ms)
      invalid-subscription
        ✓ ineligible querystring subscription (14985ms)
    returns
      ✓ object (9922ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

