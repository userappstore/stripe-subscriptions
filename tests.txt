

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/stripe-subscriptions/bind-stripekey
    after
      ✓ should bind data to req (62ms)

  server/stripe-subscriptions/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (6238ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (6294ms)
      ✓ should ignore user without pending confirmation (7103ms)
      ✓ should require user confirm payment (6222ms)

  server/stripe-subscriptions/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2480ms)
      ✓ should ignore administrator with amount owed requesting administration pages (2969ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (5506ms)
      ✓ should require user pay overdue invoice (4870ms)

  server/stripe-subscriptions/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages
      ✓ should ignore administrator without subscription requesting administration pages
      ✓ should ignore user with active subscription (7245ms)
      ✓ should require user create subscription (51ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (1058ms)
      ✓ should present the form for stripe.js v3 (1774ms)
    submit
      ✓ should require name for no stripe.js (6152ms)
      ✓ should require CVC for no stripe.js (6201ms)
      ✓ should require card number for no stripe.js (5848ms)
      ✓ should require expiration month for no stripe.js (6155ms)
      ✓ should require expiration year for no stripe.js (6194ms)
      ✓ should add payment information no stripe.js (screenshots) (66620ms)
      ✓ should add payment information stripe.js v3 (21253ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (260ms)
      ✓ should reject other account's customer (288ms)
      ✓ should bind data to req (241ms)
    view
      ✓ should have row for customer (screenshots) (18931ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (7120ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (175ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (608ms)
      ✓ should present the form for stripe.js v3 (1430ms)
    submit
      ✓ should require description for no stripe.js (6731ms)
      ✓ should require email for no stripe.js (6647ms)
      ✓ should require name for no stripe.js (6903ms)
      ✓ should require CVC for no stripe.js (7199ms)
      ✓ should require card number for no stripe.js (6465ms)
      ✓ should require expiration month for no stripe.js (7087ms)
      ✓ should require expiration year for no stripe.js (7135ms)
      ✓ should require description for stripe.js v3 (18682ms)
      ✓ should require email for stripe.js v3 (18467ms)
      ✓ should create billing profile for no stripe.js (8489ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (109159ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (157ms)
      ✓ should reject never published plan (680ms)
      ✓ should reject unpublished plan (856ms)
      ✓ should bind data to req (625ms)
    view
      ✓ should have row for plan (screenshots) (18000ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (655ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (161ms)
      ✓ should reject customer with coupon (2021ms)
    before
      ✓ should bind data to req (773ms)
    view
      ✓ should present the form (1584ms)
    submit
      ✓ should apply coupon (screenshots) (32409ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (159ms)
      ✓ should reject canceling subscription (8698ms)
      ✓ should reject free subscription (6170ms)
      ✓ should reject subscription with coupon (7819ms)
    before
      ✓ should bind data to req (8201ms)
    view
      ✓ should present the form (9020ms)
    submit
      ✓ should apply coupon (screenshots) (37454ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (786ms)
      ✓ should bind data to req (7587ms)
    view
      ✓ should present the charge table (screenshots) (27182ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (158ms)
      ✓ should bind data to req (335ms)
    view
      ✓ should present the coupon table (screenshots) (21259ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (660ms)
    submit
      ✓ should reject missing couponid (1309ms)
      ✓ should enforce couponid length (2252ms)
      ✓ should reject duplicate couponid (2047ms)
      ✓ should reject missing duration (1718ms)
      ✓ should enforce invalid duration (1726ms)
      ✓ should require valid amount off (1804ms)
      ✓ should require valid percent off (1692ms)
      ✓ should require valid max redemptions (1729ms)
      ✓ should require amount or percent off (1613ms)
      ✓ should require valid duration in months if repeating (1824ms)
      ✓ should require valid redeem_by if provided (2046ms)
      ✓ should create coupon (screenshots) (27635ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (832ms)
    submit
      ✓ should reject missing planid (1587ms)
      ✓ should enforce planid length (2479ms)
      ✓ should reject missing productid (1710ms)
      ✓ should reject never published product (2084ms)
      ✓ should reject unpublished product (2152ms)
      ✓ should reject missing currency (1938ms)
      ✓ should reject invalid currency (1959ms)
      ✓ should reject missing usage_type (1939ms)
      ✓ should reject missing amount (1856ms)
      ✓ should reject invalid amount (1959ms)
      ✓ should reject missing interval (1965ms)
      ✓ should reject invalid interval (1975ms)
      ✓ should reject invalid interval_count (1954ms)
      ✓ should reject invalid trial_period_days (2130ms)
      ✓ should create plan (screenshots) (28204ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (499ms)
    submit
      ✓ should reject missing name (1291ms)
      ✓ should enforce name length (2207ms)
      ✓ should reject missing statement_descriptor (1212ms)
      ✓ should create product (screenshots) (27422ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (391ms)
      ✓ should bind data to req (442ms)
    view
      ✓ should present the customer table (screenshots) (18430ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (156ms)
    before
      ✓ should bind data to req (313ms)
    view
      ✓ should present the form (817ms)
    submit
      ✓ should delete coupon (screenshots) (32041ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (148ms)
    before
      ✓ should bind data to req (643ms)
    view
      ✓ should present the form (1116ms)
    submit
      ✓ should delete plan (screenshots) (32440ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (174ms)
    before
      ✓ should bind data to req (302ms)
    view
      ✓ should present the form (764ms)
    submit
      ✓ should delete product (screenshots) (31046ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5246ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (163ms)
      ✓ should reject charge without refund request (8403ms)
      ✓ should reject denied refund (8191ms)
    before
      ✓ should bind data to req (7345ms)
    view
      ✓ should present the form (8925ms)
    submit
      ✓ should deny refund (screenshots) (44848ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (506ms)
      ✓ should bind data to req (511ms)
    view
      ✓ should present the form (916ms)
    submit
      ✓ should reject missing name (1104ms)
      ✓ should update coupon (screenshots) (32562ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (157ms)
      ✓ should reject unpublished plan (844ms)
      ✓ should bind data to req (753ms)
    view
      ✓ should present the form (1130ms)
    submit
      ✓ should reject missing productid (1526ms)
      ✓ should reject invalid trial period (2111ms)
      ✓ should update plan (screenshots) (32322ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (182ms)
      ✓ should reject unpublished product (517ms)
      ✓ should bind data to req (342ms)
    view
      ✓ should present the form (765ms)
    submit
      ✓ should reject missing name (1447ms)
      ✓ should enforce name length (2352ms)
      ✓ should reject missing statement_descriptor (1341ms)
      ✓ should reject invalid unit_label (1749ms)
      ✓ should update product (screenshots) (35426ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (166ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (154ms)
      ✓ should reject paid invoice (7129ms)
      ✓ should reject uncollectible invoice (3491ms)
    before
      ✓ should bind data to req (2427ms)
    view
      ✓ should present the form (2948ms)
    submit
      ✓ should forgive invoice (screenshots) (31593ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (8198ms)
    view
      ✓ should have row for each plan (1469ms)
      ✓ should have row for each coupon (1089ms)
      ✓ should have row for each subscription (screenshots) (23507ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (239ms)
      ✓ should bind data to req (9855ms)
    view
      ✓ should present the invoice table (screenshots) (27381ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (1782ms)
    view
      ✓ should have row for payment intent (screenshots) (23507ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (1663ms)
    view
      ✓ should have row for payment method (screenshots) (23597ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (166ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (167ms)
      ✓ should bind data to req (635ms)
    view
      ✓ should present the plan table (screenshots) (21561ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (155ms)
      ✓ should bind data to req (297ms)
    view
      ✓ should have row for product (screenshots) (20577ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (165ms)
      ✓ should reject published coupon (309ms)
    before
      ✓ should bind data to req (297ms)
    view
      ✓ should present the form (808ms)
    submit
      ✓ should publish coupon (screenshots) (31625ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (157ms)
      ✓ should reject published plan (632ms)
    before
      ✓ should bind data to req (631ms)
    view
      ✓ should present the form (1120ms)
    submit
      ✓ should publish plan (screenshots) (32068ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (169ms)
      ✓ should reject published product (330ms)
    before
      ✓ should bind data to req (359ms)
    view
      ✓ should present the form (797ms)
    submit
      ✓ should publish product (screenshots) (30878ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (159ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (166ms)
      ✓ should bind data to req (8617ms)
    view
      ✓ should have row for refund (screenshots) (41602ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (164ms)
      ✓ should reject customer without discount (952ms)
    before
      ✓ should bind data to req (1314ms)
    view
      ✓ should present the form (1979ms)
    submit
      ✓ should remove coupon (screenshots) (31296ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (167ms)
      ✓ should reject subscription without discount (9310ms)
    before
      ✓ should bind data to req (8470ms)
    view
      ✓ should present the form (10657ms)
    submit
      ✓ should remove coupon (screenshots) (38999ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (4654ms)
    view
      ✓ should have row for setup intent (screenshots) (24159ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (158ms)
      ✓ should bind data to req (7742ms)
    view
      ✓ should present the subscription table (screenshots) (28052ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (153ms)
      ✓ should reject never published coupon (319ms)
      ✓ should reject unpublished coupon (533ms)
    before
      ✓ should bind data to req (364ms)
    view
      ✓ should present the form (783ms)
    submit
      ✓ should unpublish coupon (screenshots) (31674ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (169ms)
      ✓ should never published plan (610ms)
      ✓ should reject unpublished plan (868ms)
    before
      ✓ should bind data to req (647ms)
    view
      ✓ should present the form (1109ms)
    submit
      ✓ should unpublish plan (screenshots) (31933ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (154ms)
      ✓ should never published product (298ms)
      ✓ should reject unpublished product (448ms)
    before
      ✓ should bind data to req (297ms)
    view
      ✓ should present the form (775ms)
    submit
      ✓ should unpublish product (screenshots) (30845ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (175ms)
    returns
      ✓ object (7217ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (23669ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (152ms)
    returns
      ✓ object (315ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (517ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (163ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8660ms)
    returns
      ✓ object (9680ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (185ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (201ms)
      invalid-planid-length
        ✓ posted planid is too short (193ms)
        ✓ posted planid is too long (178ms)
      invalid-productid
        ✓ missing posted productid (191ms)
        ✓ invalid posted productid (330ms)
      invalid-product
        ✓ ineligible posted product is not published (303ms)
      invalid-amount
        ✓ missing posted amount (282ms)
        ✓ invalid posted amount (568ms)
      invalid-currency
        ✓ missing posted currency (168ms)
        ✓ invalid posted currency (163ms)
      invalid-interval
        ✓ missing posted interval (395ms)
        ✓ invalid posted interval (306ms)
      invalid-interval-count
        ✓ missing posted interval_count (298ms)
        ✓ invalid posted interval_count (325ms)
      invalid-trial_period
        ✓ invalid posted trial_period (339ms)
      invalid-usage_type
        ✓ invalid posted usage_type (308ms)
    receives
      ✓ optional posted published (boolean) (544ms)
      ✓ optional posted trial_period_days (integer) (490ms)
      ✓ optional posted usage_type (licensed|metered) (502ms)
    returns
      ✓ object (504ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (175ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (277ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (350ms)
    returns
      ✓ object (360ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (154ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (162ms)
    returns
      ✓ object (3047ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (551ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (157ms)
    returns
      ✓ boolean (490ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (166ms)
    returns
      ✓ boolean (853ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (156ms)
    returns
      ✓ boolean (490ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (163ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8659ms)
    returns
      ✓ boolean (8000ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (158ms)
    returns
      ✓ object (6929ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (30361ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (2184ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5415ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid (41ms)
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1637ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (4183ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (163ms)
    returns
      ✓ object (783ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (889ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (162ms)
    returns
      ✓ object (299ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (542ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (24692ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (164ms)
    returns
      ✓ object (9173ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (27941ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (160ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (293ms)
    receives
      ✓ object (1073ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (220ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (8260ms)
    returns
      ✓ object (10298ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (153ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (8240ms)
    returns
      ✓ object (7507ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (152ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (307ms)
        ✓ ineligible querystring coupon is unpublished (301ms)
    returns
      ✓ object (506ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid (47ms)
        ✓ invalid querystring couponid (158ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (327ms)
        ✓ ineligible querystring coupon is already unpublished (483ms)
    returns
      ✓ object (496ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (337ms)
        ✓ invalid querystring invoiceid (150ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8226ms)
        ✓ invalid querystring invoice is marked uncollectable (5587ms)
    returns
      ✓ object (4958ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (161ms)
      invalid-plan
        ✓ ineligible querystring plan is published (630ms)
    returns
      ✓ object (823ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (151ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (637ms)
        ✓ ineligible querystring plan is already unpublished (827ms)
    returns
      ✓ object (865ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (325ms)
        ✓ invalid querystring productid (305ms)
      invalid-product
        ✓ invalid querystring product is already published (320ms)
    returns
      ✓ object (486ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (176ms)
        ✓ invalid querystring productid (328ms)
      invalid-product
        ✓ ineligible querystring product is not published (335ms)
        ✓ ineligible querystring product is already unpublished (503ms)
    returns
      ✓ object (488ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (166ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (7652ms)
        ✓ ineligible querystring charge has denied request already (9046ms)
    returns
      ✓ object (7809ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (406ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9367ms)
    returns
      ✓ object (8226ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (9550ms)
        ✓ ineligible subscription has coupon (9651ms)
      invalid-couponid
        ✓ missing posted couponid (8088ms)
        ✓ invalid posted couponid (8059ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (7844ms)
        ✓ ineligible posted coupon is unpublished (8960ms)
    returns
      ✓ object (9794ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid (39ms)
        ✓ invalid querystring setupintentid
    returns
      ✓ object (3193ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4125ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (171ms)
    returns
      ✓ object (7269ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (25819ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (162ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (486ms)
      invalid-name
        ✓ missing posted name (315ms)
        ✓ invalid posted name (407ms)
    receives
      ✓ required posted name (476ms)
    returns
      ✓ object (511ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (151ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (977ms)
      invalid-productid
        ✓ invalid posted productid (765ms)
      invalid-product
        ✓ ineligible posted product is not published (939ms)
        ✓ ineligible posted product is unpublished (1154ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (885ms)
        ✓ ineligible posted trial_period_days is negative (1107ms)
        ✓ ineligible posted trial_period_days greater than 365 (808ms)
    receives
      ✓ optional posted trial_period_days (integer) (826ms)
    returns
      ✓ object (1080ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (192ms)
        ✓ invalid querystring productid (305ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (480ms)
      invalid-name
        ✓ invalid posted name (292ms)
      invalid-name-length
        ✓ posted name too short (319ms)
        ✓ posted name too long (301ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (327ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (315ms)
        ✓ posted statement_descriptor too long (289ms)
      invalid-unit_label
        ✓ missing posted unit_label (317ms)
    receives
      ✓ optional posted name (503ms)
      ✓ optional posted statement_descriptor (502ms)
      ✓ optional posted unit_label (461ms)
    returns
      ✓ object (486ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (322ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (336ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (15274ms)
    returns
      ✓ object (7730ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (15805ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (39ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7686ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9601ms)
        ✓ ineligible querystring subscription is free (7381ms)
        ✓ ineligible querystring subscription is in free trial (6578ms)
    returns
      ✓ object (9413ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (38ms)
    returns
      ✓ object (272ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1590ms)
        ✓ ineligible posted payment method (1744ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (269ms)
        ✓ invalid posted paymentmethodid (226ms)
    object
      ✓ object (1705ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (243ms)
    receives
      ✓ optionally-required posted name (225ms)
      ✓ optionally-required posted cvc (277ms)
      ✓ optionally-required posted number (263ms)
      ✓ optionally-required posted exp_month (221ms)
      ✓ optionally-required posted exp_year (232ms)
      ✓ optionally-required posted token (236ms)
    returns
      ✓ object (1381ms)
    configuration
      ✓ environment STRIPE_JS (245ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (10987ms)
        ✓ ineligible querystring charge has refund request (9400ms)
      invalid-account
        ✓ ineligible accessing account (8595ms)
    returns
      ✓ object (7609ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (9132ms)
        ✓ ineligible querystring charge is out of refund period (7859ms)
      invalid-account
        ✓ ineligible accessing account (8591ms)
    returns
      ✓ object (8636ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (9025ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1726ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (273ms)
        ✓ invalid posted paymentmethodid (237ms)
    returns
      ✓ object (1836ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (502ms)
        ✓ invalid querystring customerid (636ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (872ms)
      invalid-account
        ✓ ineligible accessing account (940ms)
      invalid-planid
        ✓ missing posted planid (1684ms)
        ✓ invalid posted planid (1706ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2219ms)
        ✓ ineligible posted plan is unpublished (2364ms)
    returns
      ✓ object (4283ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (8397ms)
      invalid-account
        ✓ ineligible accessing account (5337ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (5547ms)
        ✓ invalid posted quantity is negative (5846ms)
      invalid-action
        ✓ missing posted action (4979ms)
        ✓ invalid posted action (4883ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (4983ms)
        ✓ invalid posted subscriptionitemid (5887ms)
    receives
      ✓ required posted quantity (6186ms)
      ✓ required posted action (6084ms)
      ✓ required posted subscriptionitemid (5580ms)
    returns
      ✓ object (5235ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1443ms)
    returns
      ✓ object (1677ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (263ms)
    returns
      ✓ boolean (904ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7580ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (7493ms)
    returns
      ✓ boolean (7376ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (8847ms)
    returns
      ✓ object (8018ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (17505ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (1962ms)
    returns
      ✓ object (1774ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (5192ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1767ms)
    returns
      ✓ object (1539ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (4147ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (130ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (646ms)
    returns
      ✓ object (672ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1001ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (130ms)
      invalid-product
        ✓ ineligible querystring product is not published (325ms)
    returns
      ✓ object (334ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (366ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (766ms)
        ✓ invalid querystring refundid (886ms)
      invalid-account
        ✓ ineligible accessing account (9452ms)
    returns
      ✓ object (8969ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (23291ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (7370ms)
      invalid-account
        ✓ ineligible accessing account (7040ms)
    returns
      ✓ object (11809ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (252ms)
        ✓ invalid querystring customerid (218ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (1025ms)
      invalid-account
        ✓ ineligible account accessing (515ms)
      invalid-couponid
        ✓ missing posted couponid (235ms)
        ✓ invalid posted couponid (255ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (611ms)
        ✓ invalid posted coupon is unpublished (714ms)
    returns
      ✓ object (810ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2981ms)
        ✓ ineligible posted payment method (6925ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (6714ms)
        ✓ invalid querystring invoice is marked uncollectable (5120ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2485ms)
        ✓ invalid posted paymentmethodid (2532ms)
    returns
      ✓ object (6360ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (1734ms)
    returns
      ✓ object (2378ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1594ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1699ms)
    returns
      ✓ object (3172ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3152ms)
    returns
      ✓ object (3650ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7746ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9375ms)
    returns
      ✓ object (7434ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (10097ms)
        ✓ invalid querystring subscription is canceling (9743ms)
      invalid-account
        ✓ ineligible accessing account (7251ms)
      invalid-couponid
        ✓ missing posted couponid (7607ms)
        ✓ invalid posted couponid (9022ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (8330ms)
        ✓ invalid posted coupon is unpublished (8059ms)
        ✓ invalid posted coupon is other currency (7488ms)
    returns
      ✓ object (8522ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (13970ms)
      invalid-planid
        ✓ missing posted planid (9485ms)
        ✓ invalid posted planid (8316ms)
      invalid-plan
        ✓ invalid posted plan is not published (7816ms)
        ✓ invalid posted plan is unpublished (7591ms)
        ✓ invalid posted plan is unchanged (7540ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (5936ms)
    returns
      ✓ object (9040ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7594ms)
      invalid-quantity
        ✓ invalid posted quantity (8555ms)
        ✓ invalid posted quantity is unchanged (7496ms)
        ✓ invalid posted quantity is negative (7799ms)
        ✓ invalid posted quantity is zero (37312ms)
    returns
      ✓ object (8190ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (9118ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (7040ms)
        ✓ invalid posted tax_percent is unchanged (7911ms)
        ✓ invalid posted tax_percent is negative (7851ms)
    returns
      ✓ object (8168ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3595ms)
    returns
      ✓ object (3140ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (4276ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (44ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (14430ms)
    returns
      ✓ object (7826ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ integer (12806ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (15922ms)
      invalid-subscription
        ✓ ineligible querystring subscription (14806ms)
    returns
      ✓ object (8190ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

