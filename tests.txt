

  index
    STRIPE_JS
      Use client-side stripe.js in browser
        ✓ default unset
        ✓ Integer
    MAXIMUM_STRIPE_RETRIES
      Retry Stripe web requests
        ✓ default 0
        ✓ Integer
    SUBSCRIPTION_WEBHOOK_ENDPOINT_SECRET
      Secret provided by Stripe to sign webhooks
        ✓ String
    STRIPE_KEY
      The `sk_test_xxx` key from Stripe
        ✓ String
    STRIPE_PUBLISHABLE_KEY
      The `pk_test_xxx` key from Stripe
        ✓ String
    REQUIRE_SUBSCRIPTION
      Users must create subscription to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT
      Users must resolve unpaid invoices to access application
        ✓ default unset
        ✓ Boolean
    REQUIRE_PAYMENT_CONFIRMATION
      Users must resolve payment confirmations to access application
        ✓ default unset
        ✓ Boolean
    OVERDUE_INVOICE_THRESHOLD
      Duration in days to allow open invoices before enforcing payment
        ✓ default 1
        ✓ Integer
    START_SUBSCRIPTION_PATH
      Alternate URL path to your start subscription flow
        ✓ default /account/subscriptions/start-subscription
        ✓ String

  server/bind-stripekey
    after
      ✓ should bind data to req (53ms)

  server/require-payment-confirmation
    after
      ✓ should ignore guests
      ✓ should ignore user with pending confirmations requesting account pages (14735ms)
      ✓ should ignore administrators with pending confirmations requesting administration pages (6619ms)
      ✓ should ignore user without pending confirmation (8230ms)
      ✓ should require user confirm payment (7362ms)

  server/require-payment
    after
      ✓ should ignore guests
      ✓ should ignore user with amount owed requesting account pages (2380ms)
      ✓ should ignore administrator with amount owed requesting administration pages (2085ms)
      ✓ should ignore user without amount owed
      ✓ should ignore user with open but not overdue invoice (6221ms)
      ✓ should require user pay overdue invoice (5711ms)

  server/require-subscription
    after
      ✓ should ignore guests
      ✓ should ignore user without subscription requesting account pages
      ✓ should ignore administrator without subscription requesting administration pages
      ✓ should ignore user with active subscription (7235ms)
      ✓ should require user create subscription (52ms)

  /account/subscriptions/add-payment-method
    view
      ✓ should present the form for no stripe.js (1035ms)
      ✓ should present the form for stripe.js v3 (1891ms)
    submit
      ✓ should require name for no stripe.js (6094ms)
      ✓ should require CVC for no stripe.js (6315ms)
      ✓ should require card number for no stripe.js (5836ms)
      ✓ should require expiration month for no stripe.js (6126ms)
      ✓ should require expiration year for no stripe.js (6119ms)
      ✓ should add payment information no stripe.js (screenshots) (69237ms)
      ✓ should add payment information stripe.js v3 (21143ms)

  /account/subscriptions/billing-profile
    before
      ✓ should reject invalid customer (255ms)
      ✓ should reject other account's customer (281ms)
      ✓ should bind data to req (246ms)
    view
      ✓ should have row for customer (screenshots) (20361ms)

  /account/subscriptions/billing-profiles
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/cancel-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
      ✓ should reject other account's subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /account/subscriptions/change-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should remove the form if there are no plans
    submit
      ✓ should apply plan update (screenshots)
    errors
      ✓ should reject paid plan without payment information

  /account/subscriptions/confirm-payment
    before
      ✓ should bind data to req (7791ms)
    view
      ✓ should display stripe.js confirmation

  /account/subscriptions/confirm-subscription
    exceptions
      ✓ invalid-planid (180ms)
      ✓ invalid-plan
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should start subscription (screenshots)
    errors
      ✓ invalid-paymentmethodid

  /account/subscriptions/create-billing-profile
    view
      ✓ should present the form for no stripe.js (600ms)
      ✓ should present the form for stripe.js v3 (1499ms)
    submit
      ✓ should require description for no stripe.js (6812ms)
      ✓ should require email for no stripe.js (6570ms)
      ✓ should require name for no stripe.js (6756ms)
      ✓ should require CVC for no stripe.js (7187ms)
      ✓ should require card number for no stripe.js (6853ms)
      ✓ should require expiration month for no stripe.js (7139ms)
      ✓ should require expiration year for no stripe.js (6778ms)
      ✓ should require description for stripe.js v3 (18397ms)
      ✓ should require email for stripe.js v3 (18476ms)
      ✓ should create billing profile for no stripe.js (8485ms)
      ✓ should create billing profile for stripe.js v3 (screenshots) (109735ms)

  /account/subscriptions/delete-billing-profile
    exceptions
      ✓ invalid-customerid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should delete billing profile (screenshots)

  /account/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should have row for each invoice
      ✓ should have row for each customer
      ✓ should have row for each subscription

  /account/subscriptions/invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should have row for invoice (screenshots)

  /account/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/pay-invoice
    exceptions
      ✓ should reject invalid invoice
      ✓ invalid-account
      ✓ should reject paid invoice
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should pay invoice (screenshots)

  /account/subscriptions/plan
    before
      ✓ should reject invalid plan (175ms)
      ✓ should reject never published plan (785ms)
      ✓ should reject unpublished plan (947ms)
      ✓ should bind data to req (669ms)
    view
      ✓ should have row for plan (screenshots) (20125ms)

  /account/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/refund-invoice
    exceptions
      ✓ invalid-invoiceid
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should cancel subscription (screenshots)

  /account/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /account/subscriptions/request-refund
    exceptions
      ✓ invalid-invoice
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should create refund request (screenshots)

  /account/subscriptions/subscription
    exceptions
      ✓ invalid-subscriptionid (537ms)
      ✓ invalid-account
    before
      ✓ should bind data to req
    view
      ✓ should present the subscription table (screenshots)

  /account/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/apply-customer-coupon
    exceptions
      ✓ should reject invalid customer (152ms)
      ✓ should reject customer with coupon (1895ms)
    before
      ✓ should bind data to req (876ms)
    view
      ✓ should present the form (1207ms)
    submit
      ✓ should apply coupon (screenshots) (38092ms)

  /administrator/subscriptions/apply-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (158ms)
      ✓ should reject canceling subscription (9319ms)
      ✓ should reject free subscription (5751ms)
      ✓ should reject subscription with coupon (12032ms)
    before
      ✓ should bind data to req (9755ms)
    view
      ✓ should present the form (7776ms)
    submit
      ✓ should apply coupon (screenshots) (45346ms)

  /administrator/subscriptions/charge
    before
      ✓ should reject invalid charge (825ms)
      ✓ should bind data to req (8261ms)
    view
      ✓ should present the charge table (screenshots) (31044ms)

  /administrator/subscriptions/charges
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/coupon
    before
      ✓ should reject invalid coupon (153ms)
      ✓ should bind data to req (365ms)
    view
      ✓ should present the coupon table (screenshots) (23922ms)

  /administrator/subscriptions/coupons
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/create-coupon
    view
      ✓ should present the form (549ms)
    submit
      ✓ should reject missing couponid (1320ms)
      ✓ should enforce couponid length (2182ms)
      ✓ should reject duplicate couponid (2055ms)
      ✓ should reject missing duration (1743ms)
      ✓ should enforce invalid duration (1725ms)
      ✓ should require valid amount off (1811ms)
      ✓ should require valid percent off (1680ms)
      ✓ should require valid max redemptions (1695ms)
      ✓ should require amount or percent off (1574ms)
      ✓ should require valid duration in months if repeating (1837ms)
      ✓ should require valid redeem_by if provided (2018ms)
      ✓ should create coupon (screenshots) (30042ms)

  /administrator/subscriptions/create-plan
    view
      ✓ should present the form (812ms)
    submit
      ✓ should reject missing planid (1784ms)
      ✓ should enforce planid length (2669ms)
      ✓ should reject missing productid (1663ms)
      ✓ should reject never published product (2139ms)
      ✓ should reject unpublished product (2135ms)
      ✓ should reject missing currency (2086ms)
      ✓ should reject invalid currency (2075ms)
      ✓ should reject missing usage_type (2041ms)
      ✓ should reject missing amount (2017ms)
      ✓ should reject invalid amount (2043ms)
      ✓ should reject missing interval (2131ms)
      ✓ should reject invalid interval (2122ms)
      ✓ should reject invalid interval_count (2086ms)
      ✓ should reject invalid trial_period_days (2181ms)
      ✓ should create plan (screenshots) (31025ms)

  /administrator/subscriptions/create-product
    view
      ✓ should present the form (507ms)
    submit
      ✓ should reject missing name (1296ms)
      ✓ should enforce name length (2220ms)
      ✓ should reject missing statement_descriptor (1199ms)
      ✓ should create product (screenshots) (29949ms)

  /administrator/subscriptions/customer
    before
      ✓ should reject invalid customer (408ms)
      ✓ should bind data to req (247ms)
    view
      ✓ should present the customer table (screenshots) (19851ms)

  /administrator/subscriptions/customers
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/delete-coupon
    exceptions
      ✓ should reject invalid couponid (140ms)
    before
      ✓ should bind data to req (338ms)
    view
      ✓ should present the form (829ms)
    submit
      ✓ should delete coupon (screenshots) (36526ms)

  /administrator/subscriptions/delete-plan
    exceptions
      ✓ should reject invalid planid (152ms)
    before
      ✓ should bind data to req (674ms)
    view
      ✓ should present the form (1141ms)
    submit
      ✓ should delete plan (screenshots) (37241ms)

  /administrator/subscriptions/delete-product
    exceptions
      ✓ should reject invalid productid (149ms)
    before
      ✓ should bind data to req (301ms)
    view
      ✓ should present the form (787ms)
    submit
      ✓ should delete product (screenshots) (35473ms)

  /administrator/subscriptions/delete-subscription
    exceptions
      ✓ should reject missing subscription
      ✓ should reject invalid subscription
      ✓ should reject canceled subscription
    before
      ✓ should bind data to req
    view
      ✓ should present the form
      ✓ should show fields for free plan cancelations
      ✓ should show fields for free trial cancelations
      ✓ should show fields for cancelation with credit or refund
    submit
      ✓ should cancel free subscription immediately (screenshots) (5314ms)
      ✓ should cancel free subscription at period end
      ✓ should cancel free trial immediately
      ✓ should cancel free trial at period end
      ✓ should cancel paid subscription and credit account
      ✓ should cancel paid subscription and show refund

  /administrator/subscriptions/deny-refund
    exceptions
      ✓ should reject invalid chargeid (147ms)
      ✓ should reject charge without refund request (7685ms)
      ✓ should reject denied refund (8588ms)
    before
      ✓ should bind data to req (11118ms)
    view
      ✓ should present the form (8747ms)
    submit
      ✓ should deny refund (screenshots) (49626ms)

  /administrator/subscriptions/edit-coupon
    before
      ✓ should reject invalid couponid
      ✓ should reject unpublished coupon (528ms)
      ✓ should bind data to req (323ms)
    view
      ✓ should present the form (796ms)
    submit
      ✓ should reject missing name (1255ms)
      ✓ should update coupon (screenshots) (36961ms)

  /administrator/subscriptions/edit-plan
    before
      ✓ should reject invalid planid (156ms)
      ✓ should reject unpublished plan (872ms)
      ✓ should bind data to req (805ms)
    view
      ✓ should present the form (1226ms)
    submit
      ✓ should reject missing productid (1949ms)
      ✓ should reject invalid trial period (2642ms)
      ✓ should update plan (screenshots) (41728ms)

  /administrator/subscriptions/edit-product
    before
      ✓ should reject invalid productid (420ms)
      ✓ should reject unpublished product (524ms)
      ✓ should bind data to req (353ms)
    view
      ✓ should present the form (789ms)
    submit
      ✓ should reject missing name (1759ms)
      ✓ should enforce name length (2570ms)
      ✓ should reject missing statement_descriptor (1499ms)
      ✓ should reject invalid unit_label (1878ms)
      ✓ should update product (screenshots) (41730ms)

  /administrator/subscriptions/flag-charge
    exceptions
      ✓ should reject invalid chargeid (164ms)
      ✓ should reject flagged charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should flag charge (screenshots)

  /administrator/subscriptions/forgive-invoice
    exceptions
      ✓ should reject invalid invoiceid (157ms)
      ✓ should reject paid invoice (7403ms)
      ✓ should reject uncollectible invoice (3362ms)
    before
      ✓ should bind data to req (5217ms)
    view
      ✓ should present the form (3027ms)
    submit
      ✓ should forgive invoice (screenshots) (36114ms)

  /administrator/subscriptions
    before
      ✓ should bind data to req (9310ms)
    view
      ✓ should have row for each plan (1756ms)
      ✓ should have row for each coupon (1121ms)
      ✓ should have row for each subscription (screenshots) (25101ms)

  /administrator/subscriptions/invoice
    before
      ✓ should reject invalid invoiceid (171ms)
      ✓ should bind data to req (10588ms)
    view
      ✓ should present the invoice table (screenshots) (30740ms)

  /administrator/subscriptions/invoices
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-intent
    before
      ✓ should reject invalid paymentintentid
      ✓ should bind data to req (1917ms)
    view
      ✓ should have row for payment intent (screenshots) (25494ms)

  /administrator/subscriptions/payment-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payment-method
    before
      ✓ should reject invalid paymentmethodid
      ✓ should bind data to req (2010ms)
    view
      ✓ should have row for payment method (screenshots) (25346ms)

  /administrator/subscriptions/payment-methods
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/payout
    before
      ✓ should reject invalid payoutid (161ms)

  /administrator/subscriptions/plan
    before
      ✓ should reject invalid planid (162ms)
      ✓ should bind data to req (688ms)
    view
      ✓ should present the plan table (screenshots) (24348ms)

  /administrator/subscriptions/plans
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/product
    before
      ✓ should reject invalid productid (138ms)
      ✓ should bind data to req (322ms)
    view
      ✓ should have row for product (screenshots) (22563ms)

  /administrator/subscriptions/products
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/publish-coupon
    exceptions
      ✓ should reject invalid couponid (152ms)
      ✓ should reject published coupon (393ms)
    before
      ✓ should bind data to req (353ms)
    view
      ✓ should present the form (783ms)
    submit
      ✓ should publish coupon (screenshots) (36209ms)

  /administrator/subscriptions/publish-plan
    exceptions
      ✓ should reject invalid planid (156ms)
      ✓ should reject published plan (683ms)
    before
      ✓ should bind data to req (856ms)
    view
      ✓ should present the form (1194ms)
    submit
      ✓ should publish plan (screenshots) (36423ms)

  /administrator/subscriptions/publish-product
    exceptions
      ✓ should reject invalid productid (300ms)
      ✓ should reject published product (310ms)
    before
      ✓ should bind data to req (313ms)
    view
      ✓ should present the form (757ms)
    submit
      ✓ should publish product (screenshots) (34782ms)

  /administrator/subscriptions/refund-charge
    exceptions
      ✓ should reject invalid chargeid (196ms)
      ✓ should reject refunded charge
    before
      ✓ should bind data to req
    view
      ✓ should present the form
    submit
      ✓ should refund charge (screenshots)

  /administrator/subscriptions/refund-requests
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/refund
    before
      ✓ should reject invalid refundid (173ms)
      ✓ should bind data to req (9820ms)
    view
      ✓ should have row for refund (screenshots) (34204ms)

  /administrator/subscriptions/refunds
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/revoke-customer-coupon
    exceptions
      ✓ should reject invalid customer (160ms)
      ✓ should reject customer without discount (1154ms)
    before
      ✓ should bind data to req (1631ms)
    view
      ✓ should present the form (1826ms)
    submit
      ✓ should remove coupon (screenshots) (34870ms)

  /administrator/subscriptions/revoke-subscription-coupon
    exceptions
      ✓ should reject invalid subscription (160ms)
      ✓ should reject subscription without discount (9615ms)
    before
      ✓ should bind data to req (8853ms)
    view
      ✓ should present the form (25390ms)
    submit
      ✓ should remove coupon (screenshots) (47549ms)

  /administrator/subscriptions/setup-intent
    before
      ✓ should reject invalid setupintentid
      ✓ should bind data to req (4918ms)
    view
      ✓ should have row for setup intent (screenshots) (26898ms)

  /administrator/subscriptions/setup-intents
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/subscription
    before
      ✓ should reject invalid subscriptionid (157ms)
      ✓ should bind data to req (7541ms)
    view
      ✓ should present the subscription table (screenshots) (29828ms)

  /administrator/subscriptions/subscriptions
    before
      ✓ should bind data to req
    view
      ✓ should return one page (screenshots)
      ✓ should change page size
      ✓ should change offset

  /administrator/subscriptions/unpublish-coupon
    exceptions
      ✓ should reject invalid couponid (148ms)
      ✓ should reject never published coupon (302ms)
      ✓ should reject unpublished coupon (508ms)
    before
      ✓ should bind data to req (327ms)
    view
      ✓ should present the form (835ms)
    submit
      ✓ should unpublish coupon (screenshots) (36298ms)

  /administrator/subscriptions/unpublish-plan
    exceptions
      ✓ should reject invalid planid (160ms)
      ✓ should never published plan (677ms)
      ✓ should reject unpublished plan (905ms)
    before
      ✓ should bind data to req (688ms)
    view
      ✓ should present the form (1152ms)
    submit
      ✓ should unpublish plan (screenshots) (36487ms)

  /administrator/subscriptions/unpublish-product
    exceptions
      ✓ should reject invalid productid (157ms)
      ✓ should never published product (317ms)
      ✓ should reject unpublished product (521ms)
    before
      ✓ should bind data to req (329ms)
    view
      ✓ should present the form (796ms)
    submit
      ✓ should unpublish product (screenshots) (34846ms)

  /api/administrator/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (167ms)
    returns
      ✓ object (7938ms)

  /api/administrator/subscriptions/charges-count
    returns
      ✓ integer (22607ms)

  /api/administrator/subscriptions/charges
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (154ms)
    returns
      ✓ object (314ms)

  /api/administrator/subscriptions/coupons-count
    returns
      ✓ integer (531ms)

  /api/administrator/subscriptions/coupons
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (151ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8590ms)
    returns
      ✓ object (8646ms)

  /api/administrator/subscriptions/create-coupon
    exceptions
      invalid-couponid
        ✓ missing posted couponid
        ✓ invalid posted couponid is not alphanumeric_
      invalid-amount_off
        ✓ missing posted amount_off
        ✓ invalid posted amount_off
      invalid-currency
        ✓ missing posted currency
        ✓ invalid posted currency
      invalid-percent_off
        ✓ invalid posted percent_off
      invalid-duration
        ✓ invalid posted duration
      invalid-duration_in_months
        ✓ missing posted duration_in_months
        ✓ invalid posted duration_in_months
      invalid-redeem_by_meridiem
        ✓ invalid posted redeem_by_meridiem
      invalid-redeem_by
        ✓ invalid posted redeem_by
    receives
      ✓ required posted duration
      ✓ optionally-required posted amount_off (integer, or percent_off)
      ✓ optionally-required posted currency (string, if amount_off)
      ✓ optionally-required posted percent_off (integer, or amount_off)
      ✓ optionally-required posted expire date 
      ✓ optionally-required posted duration_in_months
    returns
      ✓ object (188ms)

  /api/administrator/subscriptions/create-plan
    exceptions
      invalid-planid
        ✓ invalid posted planid is not alphanumeric_ (181ms)
      invalid-planid-length
        ✓ posted planid is too short (189ms)
        ✓ posted planid is too long (186ms)
      invalid-productid
        ✓ missing posted productid (201ms)
        ✓ invalid posted productid (326ms)
      invalid-product
        ✓ ineligible posted product is not published (321ms)
      invalid-amount
        ✓ missing posted amount (333ms)
        ✓ invalid posted amount (302ms)
      invalid-currency
        ✓ missing posted currency (191ms)
        ✓ invalid posted currency (177ms)
      invalid-interval
        ✓ missing posted interval (308ms)
        ✓ invalid posted interval (304ms)
      invalid-interval-count
        ✓ missing posted interval_count (366ms)
        ✓ invalid posted interval_count (309ms)
      invalid-trial_period
        ✓ invalid posted trial_period (302ms)
      invalid-usage_type
        ✓ invalid posted usage_type (482ms)
    receives
      ✓ optional posted published (boolean) (530ms)
      ✓ optional posted trial_period_days (integer) (536ms)
      ✓ optional posted usage_type (licensed|metered) (520ms)
    returns
      ✓ object (504ms)
    configuration
      ✓ environment MINIMUM_PLANID_LENGTH (205ms)
      ✓ environment MAXIMUM_PLANID_LENGTH (186ms)

  /api/administrator/subscriptions/create-product
    exceptions
      invalid-name
        ✓ missing posted name
      invalid-product-name-length
        ✓ posted name too short
        ✓ posted name too long
      invalid-statement_descriptor
        ✓ missing posted statement_descriptor
    receives
      ✓ optional posted published (boolean) (360ms)
    returns
      ✓ object (341ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH

  /api/administrator/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (153ms)
      invalid-amount
        ✓ missing posted amount
        ✓ invalid posted amount
        ✓ invalid posted amount is negative
        ✓ invalid posted amount exceeds charge
    returns
      ✓ object

  /api/administrator/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (152ms)
    returns
      ✓ object (2717ms)

  /api/administrator/subscriptions/customers-count
    returns
      ✓ integer (476ms)

  /api/administrator/subscriptions/customers
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/delete-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (144ms)
    returns
      ✓ boolean (691ms)

  /api/administrator/subscriptions/delete-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (159ms)
    returns
      ✓ boolean (1030ms)

  /api/administrator/subscriptions/delete-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (299ms)
    returns
      ✓ boolean (514ms)

  /api/administrator/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (150ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8138ms)
    returns
      ✓ boolean (9004ms)

  /api/administrator/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid (153ms)
    returns
      ✓ object (14920ms)

  /api/administrator/subscriptions/invoices-count
    returns
      ✓ integer (31131ms)

  /api/administrator/subscriptions/invoices
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
    returns
      ✓ object (1886ms)

  /api/administrator/subscriptions/payment-intents-count
    returns
      ✓ integer (5991ms)

  /api/administrator/subscriptions/payment-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
    returns
      ✓ object (1514ms)

  /api/administrator/subscriptions/payment-methods-count
    returns
      ✓ integer (4449ms)

  /api/administrator/subscriptions/payment-methods
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (165ms)
    returns
      ✓ object (678ms)

  /api/administrator/subscriptions/plans-count
    returns
      ✓ integer (1246ms)

  /api/administrator/subscriptions/plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (158ms)
    returns
      ✓ object (341ms)

  /api/administrator/subscriptions/products-count
    returns
      ✓ integer (524ms)

  /api/administrator/subscriptions/products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund-requests-count
    returns
      ✓ integer (24428ms)

  /api/administrator/subscriptions/refund-requests
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/refund
    exceptions
      ✓ invalid querystring refundid
      ✓ missing querystring refundid (167ms)
    returns
      ✓ object (10150ms)

  /api/administrator/subscriptions/refunds-count
    returns
      ✓ integer (32555ms)

  /api/administrator/subscriptions/refunds
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/reset-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid (150ms)
      invalid-customeir
        ✓ invalid querystring customer has no discount (285ms)
    receives
      ✓ object (1147ms)

  /api/administrator/subscriptions/reset-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (165ms)
      invalid-subscription
        ✓ ineligible querystring subscription has no discount (7757ms)
    returns
      ✓ object (8962ms)

  /api/administrator/subscriptions/set-charge-flagged
    exceptions
      invalid-chargeid
        ✓ missing querystring charge
        ✓ invalid querystring charge (153ms)
      invalid-charge
        ✓ ineligible querystring charge is already flagged (9173ms)
    returns
      ✓ object (7993ms)

  /api/administrator/subscriptions/set-coupon-published
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (157ms)
      invalid-coupon
        ✓ ineligible querystring coupon is published (323ms)
        ✓ ineligible querystring coupon is unpublished (331ms)
    returns
      ✓ object (569ms)

  /api/administrator/subscriptions/set-coupon-unpublished
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (177ms)
      invalid-coupon
        ✓ ineligible querystring coupon is not published (311ms)
        ✓ ineligible querystring coupon is already unpublished (488ms)
    returns
      ✓ object (457ms)

  /api/administrator/subscriptions/set-invoice-uncollectible
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid (153ms)
        ✓ invalid querystring invoiceid (157ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (8183ms)
        ✓ invalid querystring invoice is marked uncollectable (6942ms)
    returns
      ✓ object (4534ms)

  /api/administrator/subscriptions/set-plan-published
    exceptions
      invalid-planid
        ✓ missing querystring planid (41ms)
        ✓ invalid querystring planid (157ms)
      invalid-plan
        ✓ ineligible querystring plan is published (861ms)
    returns
      ✓ object (895ms)

  /api/administrator/subscriptions/set-plan-unpublished
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (155ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (646ms)
        ✓ ineligible querystring plan is already unpublished (975ms)
    returns
      ✓ object (871ms)

  /api/administrator/subscriptions/set-product-published
    exceptions
      invalid-productid
        ✓ missing querystring productid (306ms)
        ✓ invalid querystring productid (298ms)
      invalid-product
        ✓ invalid querystring product is already published (316ms)
    returns
      ✓ object (620ms)

  /api/administrator/subscriptions/set-product-unpublished
    exceptions
      invalid-productid
        ✓ missing querystring productid (175ms)
        ✓ invalid querystring productid (484ms)
      invalid-product
        ✓ ineligible querystring product is not published (306ms)
        ✓ ineligible querystring product is already unpublished (566ms)
    returns
      ✓ object (501ms)

  /api/administrator/subscriptions/set-refund-request-denied
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid (166ms)
      invalid-charge
        ✓ ineligible querystring charge has no refund request (8593ms)
        ✓ ineligible querystring charge has denied request already (8368ms)
    returns
      ✓ object (8547ms)

  /api/administrator/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (188ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9767ms)
    returns
      ✓ object (7575ms)

  /api/administrator/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ ineligible subscription is canceling (9766ms)
        ✓ ineligible subscription has coupon (12701ms)
      invalid-couponid
        ✓ missing posted couponid (9112ms)
        ✓ invalid posted couponid (7784ms)
      invalid-coupon
        ✓ ineligible posted coupon is not published (7819ms)
        ✓ ineligible posted coupon is unpublished (11707ms)
    returns
      ✓ object (9197ms)

  /api/administrator/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
    returns
      ✓ object (3260ms)

  /api/administrator/subscriptions/setup-intents-count
    returns
      ✓ integer (4359ms)

  /api/administrator/subscriptions/setup-intents
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid (383ms)
    returns
      ✓ object (7796ms)

  /api/administrator/subscriptions/subscriptions-count
    returns
      ✓ integer (24186ms)

  /api/administrator/subscriptions/subscriptions
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/administrator/subscriptions/update-coupon
    exceptions
      invalid-couponid
        ✓ missing querystring couponid
        ✓ invalid querystring couponid (156ms)
      invalid-coupon
        ✓ ineligible querystring coupon is unpublished (557ms)
      invalid-name
        ✓ missing posted name (473ms)
        ✓ invalid posted name (306ms)
    receives
      ✓ required posted name (496ms)
    returns
      ✓ object (525ms)

  /api/administrator/subscriptions/update-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (155ms)
      invalid-plan
        ✓ ineligible querystring plan is unpublished (1052ms)
      invalid-productid
        ✓ invalid posted productid (807ms)
      invalid-product
        ✓ ineligible posted product is not published (961ms)
        ✓ ineligible posted product is unpublished (1276ms)
      invalid-trial_period_days
        ✓ invalid posted trial_period_days (961ms)
        ✓ ineligible posted trial_period_days is negative (1152ms)
        ✓ ineligible posted trial_period_days greater than 365 (1038ms)
    receives
      ✓ optional posted trial_period_days (integer) (847ms)
    returns
      ✓ object (1166ms)

  /api/administrator/subscriptions/update-product
    exceptions
      invalid-productid
        ✓ missing querystring productid (195ms)
        ✓ invalid querystring productid (304ms)
      invalid-product
        ✓ ineligible querystring product is unpublished (537ms)
      invalid-name
        ✓ invalid posted name (470ms)
      invalid-name-length
        ✓ posted name too short (325ms)
        ✓ posted name too long (311ms)
      invalid-statement_descriptor
        ✓ invalid posted statement_descriptor (375ms)
      invalid-statement_descriptor-length
        ✓ posted statement_descriptor too short (329ms)
        ✓ posted statement_descriptor too long (460ms)
      invalid-unit_label
        ✓ missing posted unit_label (328ms)
    receives
      ✓ optional posted name (516ms)
      ✓ optional posted statement_descriptor (505ms)
      ✓ optional posted unit_label (471ms)
    returns
      ✓ object (650ms)
    configuration
      ✓ environment MINIMUM_PRODUCT_NAME_LENGTH (316ms)
      ✓ environment MAXIMUM_PRODUCT_NAME_LENGTH (332ms)

  /api/administrator/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/charge
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-account
        ✓ ineligible accessing account (12144ms)
    returns
      ✓ object (9044ms)

  /api/user/subscriptions/charges-count
    returns
      ✓ integer (15374ms)

  /api/user/subscriptions/charges
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/create-cancelation-refund
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (17582ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (9046ms)
        ✓ ineligible querystring subscription is free (8551ms)
        ✓ ineligible querystring subscription is in free trial (7136ms)
    returns
      ✓ object (9227ms)

  /api/user/subscriptions/create-customer
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ object (343ms)

  /api/user/subscriptions/create-payment-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1457ms)
        ✓ ineligible posted payment method (1913ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (231ms)
        ✓ invalid posted paymentmethodid (292ms)
    object
      ✓ object (1893ms)

  /api/user/subscriptions/create-payment-method
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (260ms)
    receives
      ✓ optionally-required posted name (257ms)
      ✓ optionally-required posted cvc (224ms)
      ✓ optionally-required posted number (240ms)
      ✓ optionally-required posted exp_month (220ms)
      ✓ optionally-required posted exp_year (229ms)
      ✓ optionally-required posted token (249ms)
    returns
      ✓ object (1793ms)
    configuration
      ✓ environment STRIPE_JS (220ms)

  /api/user/subscriptions/create-refund-request
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (9303ms)
        ✓ ineligible querystring charge has refund request (7474ms)
      invalid-account
        ✓ ineligible accessing account (8643ms)
    returns
      ✓ object (13285ms)

  /api/user/subscriptions/create-refund
    exceptions
      invalid-chargeid
        ✓ missing querystring chargeid
        ✓ invalid querystring chargeid
      invalid-charge
        ✓ ineligible querystring charge is refunded (8891ms)
        ✓ ineligible querystring charge is out of refund period (8001ms)
      invalid-account
        ✓ ineligible accessing account (8207ms)
    returns
      ✓ object (9149ms)
    configuration
      ✓ environment SUBSCRIPTION_REFUND_PERIOD (9691ms)

  /api/user/subscriptions/create-setup-intent
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1587ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (221ms)
        ✓ invalid posted paymentmethodid (245ms)
    returns
      ✓ object (1952ms)

  /api/user/subscriptions/create-subscription
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (558ms)
        ✓ invalid querystring customerid (744ms)
      invalid-customer
        ✓ ineligible querystring customer requires payment method (947ms)
      invalid-account
        ✓ ineligible accessing account (1077ms)
      invalid-planid
        ✓ missing posted planid (1818ms)
        ✓ invalid posted planid (2034ms)
      invalid-plan
        ✓ ineligible posted plan is not published (2515ms)
        ✓ ineligible posted plan is unpublished (3025ms)
    returns
      ✓ object (4635ms)

  /api/user/subscriptions/create-usage-record
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is not "metered" (7696ms)
      invalid-account
        ✓ ineligible accessing account (5237ms)
      invalid-quantity
        ✓ invalid posted quantity is not integer (5354ms)
        ✓ invalid posted quantity is negative (5718ms)
      invalid-action
        ✓ missing posted action (4896ms)
        ✓ invalid posted action (5645ms)
      invalid-subscriptionitemid
        ✓ missing posted subscriptionitemid (5026ms)
        ✓ invalid posted subscriptionitemid (5298ms)
    receives
      ✓ required posted quantity (7137ms)
      ✓ required posted action (5497ms)
      ✓ required posted subscriptionitemid (5994ms)
    returns
      ✓ object (5853ms)

  /api/user/subscriptions/customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (1589ms)
    returns
      ✓ object (1559ms)

  /api/user/subscriptions/customers
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/delete-customer
    exceptions
      invalid-customerid
        ✓ missing querystring customerid
        ✓ invalid querystring customerid
      invalid-account
        ✓ ineligible accessing account (253ms)
    returns
      ✓ boolean (402ms)

  /api/user/subscriptions/delete-subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (9151ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8379ms)
    returns
      ✓ boolean (11379ms)

  /api/user/subscriptions/invoice
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (7593ms)
    returns
      ✓ object (7103ms)

  /api/user/subscriptions/invoices-count
    returns
      ✓ integer (21469ms)

  /api/user/subscriptions/invoices
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (44ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-intent
    exceptions
      invalid-paymentintentid
        ✓ missing querystring invalid
        ✓ invalid querystring invalid
      invalid-account
        ✓ ineligible accessing account (1769ms)
    returns
      ✓ object (1837ms)

  /api/user/subscriptions/payment-intents-count
    returns
      ✓ integer (5871ms)

  /api/user/subscriptions/payment-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (43ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/payment-method
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1866ms)
    returns
      ✓ object (1765ms)

  /api/user/subscriptions/payment-methods-count
    returns
      ✓ integer (4562ms)

  /api/user/subscriptions/payment-methods
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account (38ms)
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-plan
    exceptions
      invalid-planid
        ✓ missing querystring planid
        ✓ invalid querystring planid (132ms)
      invalid-plan
        ✓ ineligible querystring plan is not published (643ms)
    returns
      ✓ object (719ms)

  /api/user/subscriptions/published-plans-count
    returns
      ✓ integer (1199ms)

  /api/user/subscriptions/published-plans
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/published-product
    exceptions
      invalid-productid
        ✓ missing querystring productid
        ✓ invalid querystring productid (124ms)
      invalid-product
        ✓ ineligible querystring product is not published (349ms)
    returns
      ✓ object (318ms)

  /api/user/subscriptions/published-products-count
    returns
      ✓ integer (359ms)

  /api/user/subscriptions/published-products
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/refund
    exceptions
      invalid-refundid
        ✓ missing querystring refundid (867ms)
        ✓ invalid querystring refundid (1055ms)
      invalid-account
        ✓ ineligible accessing account (9627ms)
    returns
      ✓ object (9756ms)

  /api/user/subscriptions/refunds-count
    returns
      ✓ integer (49109ms)

  /api/user/subscriptions/refunds
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/reset-subscription-canceling
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription is active (7874ms)
      invalid-account
        ✓ ineligible accessing account (7254ms)
    returns
      ✓ object (8836ms)

  /api/user/subscriptions/set-customer-coupon
    exceptions
      invalid-customerid
        ✓ missing querystring customerid (211ms)
        ✓ invalid querystring customerid (196ms)
      invalid-customer
        ✓ invalid querystring customer has coupon (1222ms)
      invalid-account
        ✓ ineligible account accessing (463ms)
      invalid-couponid
        ✓ missing posted couponid (236ms)
        ✓ invalid posted couponid (416ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (680ms)
        ✓ invalid posted coupon is unpublished (723ms)
    returns
      ✓ object (872ms)

  /api/user/subscriptions/set-invoice-paid
    exceptions
      invalid-invoiceid
        ✓ missing querystring invoiceid
        ✓ invalid querystring invoiceid
      invalid-account
        ✓ ineligible accessing account (2350ms)
        ✓ ineligible posted payment method (7035ms)
      invalid-invoice
        ✓ invalid querystring invoice is paid (7725ms)
        ✓ invalid querystring invoice is marked uncollectable (4987ms)
      invalid-paymentmethodid
        ✓ missing posted paymentmethodid (2234ms)
        ✓ invalid posted paymentmethodid (2547ms)
    returns
      ✓ object (5992ms)

  /api/user/subscriptions/set-payment-intent-canceled
    exceptions
      invalid-paymentintentid
        ✓ missing querystring paymentintentid
        ✓ invalid querystring paymentintentid
      invalid-account
        ✓ ineligible accessing account (1787ms)
    returns
      ✓ object (2026ms)

  /api/user/subscriptions/set-payment-method-detached
    exceptions
      invalid-paymentmethodid
        ✓ missing querystring paymentmethodid
        ✓ invalid querystring paymentmethodid
      invalid-account
        ✓ ineligible accessing account (1787ms)
      invalid-paymentmethod
        ✓ invalid querystring payment method is default (1578ms)
    returns
      ✓ object (3068ms)

  /api/user/subscriptions/set-setup-intent-canceled
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (3727ms)
    returns
      ✓ object (3117ms)

  /api/user/subscriptions/set-subscription-canceled
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7332ms)
      invalid-subscription
        ✓ ineligible querystring subscription is not active (8736ms)
    returns
      ✓ object (7711ms)

  /api/user/subscriptions/set-subscription-coupon
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-subscription
        ✓ invalid querystring subscription has coupon (10134ms)
        ✓ invalid querystring subscription is canceling (9733ms)
      invalid-account
        ✓ ineligible accessing account (7348ms)
      invalid-couponid
        ✓ missing posted couponid (8144ms)
        ✓ invalid posted couponid (7659ms)
      invalid-coupon
        ✓ invalid posted coupon is not published (7976ms)
        ✓ invalid posted coupon is unpublished (8274ms)
        ✓ invalid posted coupon is other currency (7832ms)
    returns
      ✓ object (7941ms)

  /api/user/subscriptions/set-subscription-plan
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (16286ms)
      invalid-planid
        ✓ missing posted planid (7794ms)
        ✓ invalid posted planid (7418ms)
      invalid-plan
        ✓ invalid posted plan is not published (7929ms)
        ✓ invalid posted plan is unpublished (8807ms)
        ✓ invalid posted plan is unchanged (6941ms)
    invalid-paymentmethodid
      ✓ invalid customer requires payments method (6386ms)
    returns
      ✓ object (9251ms)

  /api/user/subscriptions/set-subscription-quantity
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7689ms)
      invalid-quantity
        ✓ invalid posted quantity (7675ms)
        ✓ invalid posted quantity is unchanged (7715ms)
        ✓ invalid posted quantity is negative (7788ms)
        ✓ invalid posted quantity is zero (11073ms)
    returns
      ✓ object (8260ms)

  /api/user/subscriptions/set-subscription-tax-percent
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (7390ms)
      invalid-tax_percent
        ✓ invalid posted tax_percent (8304ms)
        ✓ invalid posted tax_percent is unchanged (7924ms)
        ✓ invalid posted tax_percent is negative (7621ms)
    returns
      ✓ object (7800ms)

  /api/user/subscriptions/setup-intent
    exceptions
      invalid-setupintentid
        ✓ missing querystring setupintentid
        ✓ invalid querystring setupintentid
      invalid-account
        ✓ ineligible accessing account (5568ms)
    returns
      ✓ object (2871ms)

  /api/user/subscriptions/setup-intents-count
    returns
      ✓ integer (5050ms)

  /api/user/subscriptions/setup-intents
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/subscription
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (13810ms)
    returns
      ✓ object (8531ms)

  /api/user/subscriptions/subscriptions-count
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    returns
      ✓ integer (12762ms)

  /api/user/subscriptions/subscriptions
    exceptions
      invalid-accountid
        ✓ missing querystring accountid
        ✓ invalid querystring accountid
      invalid-account
        ✓ ineligible accessing account
    receives
      ✓ optional querystring offset (integer)
      ✓ optional querystring limit (integer)
      ✓ optional querystring all (boolean)
    returns
      ✓ array
    configuration
      ✓ environment PAGE_SIZE

  /api/user/subscriptions/upcoming-invoice
    exceptions
      invalid-subscriptionid
        ✓ missing querystring subscriptionid
        ✓ invalid querystring subscriptionid
      invalid-account
        ✓ ineligible accessing account (16623ms)
      invalid-subscription
        ✓ ineligible querystring subscription (14920ms)
    returns
      ✓ object (7131ms)

  /api/user/subscriptions/usage-record-summaries
    exceptions
      invalid-subscriptionitemid
        ✓ missing querystring subscriptionitemid
        ✓ invalid querystring subscriptionitemid
    receives
      ✓ optional querystring starting_after (string)
      ✓ optional querystring ending_before (string)
      ✓ optional querystring limit (integer)
    returns
      ✓ stripe list response
    configuration
      ✓ environment PAGE_SIZE


  966 passing (2h)

